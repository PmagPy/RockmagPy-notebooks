
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Estimate the Verwey transition temperature &#8212; RockmagPy Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MPMS_verwey_fit';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="MPMS data visualization" href="MPMS_plot.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="book/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/rockmagpy.png" class="logo__image only-light" alt="RockmagPy Documentation - Home"/>
    <script>document.write(`<img src="_static/rockmagpy.png" class="logo__image only-dark" alt="RockmagPy Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="book/intro.html">
                    RockmagPy: tools for rock magnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Nuts &amp; Bolts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rockmag_set_up.html">Getting going with Rockmag.py on jupyterhub</a></li>
<li class="toctree-l1"><a class="reference internal" href="rockmag_data_unpack.html">Rock magnetic experiments data import</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MPMS notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot.html">MPMS data visualization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Estimate the Verwey transition temperature</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks/issues/new?title=Issue%20on%20page%20%2FMPMS_verwey_fit.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MPMS_verwey_fit.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Estimate the Verwey transition temperature</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-scientific-python-libraries">Import scientific python libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-measurements">Import measurements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background-on-the-verwey-transition">Background on the Verwey transition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-verwey-transition-temperature">Estimating the Verwey transition temperature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactively-fit-the-verwey-transition">Interactively fit the Verwey transition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-rmag-verwey-estimate-function">Use the <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate</span></code> function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-second-derivative-curve">Plot the second derivative curve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-the-verwey-temperatures-for-additional-specimens">Determine the Verwey temperatures for additional specimens</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="estimate-the-verwey-transition-temperature">
<h1>Estimate the Verwey transition temperature<a class="headerlink" href="#estimate-the-verwey-transition-temperature" title="Link to this heading">#</a></h1>
<p>This using remanence upon warming curves developed through MPMS experiments and uses them to estimate the Verwey transition temperature.</p>
<section id="import-scientific-python-libraries">
<h2>Import scientific python libraries<a class="headerlink" href="#import-scientific-python-libraries" title="Link to this heading">#</a></h2>
<p>Run the cell below to import the functions needed for the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rockmag</span> <span class="k">as</span> <span class="nn">rmag</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-measurements">
<h2>Import measurements<a class="headerlink" href="#import-measurements" title="Link to this heading">#</a></h2>
<p>After having run the <a class="reference internal" href="rockmag_data_unpack.html"><span class="std std-doc">rockmag_data_unpack.ipynb</span></a> notebook, the folder <code class="docutils literal notranslate"><span class="pre">./example_data/ECMB</span></code>, has a measurements table. We can import that table for analysis into a DataFrame that we will call <code class="docutils literal notranslate"><span class="pre">measurements</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the dir_path to the directory where the measurements.txt file is located</span>
<span class="n">dir_path</span> <span class="o">=</span> <span class="s1">&#39;./example_data/ECMB&#39;</span>

<span class="n">file</span> <span class="o">=</span> <span class="n">dir_path</span> <span class="o">+</span> <span class="s1">&#39;/measurements.txt&#39;</span>
<span class="n">measurements</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="background-on-the-verwey-transition">
<h2>Background on the Verwey transition<a class="headerlink" href="#background-on-the-verwey-transition" title="Link to this heading">#</a></h2>
<p>For these mafic dikes from the East Central Minnesota batholith, the specimens exhibit a significant loss of remanence across the Verwey transition. The Verwey transition as defined by Jackson and Moskowitz (2020) is:</p>
<blockquote>
<div><p>The Verwey transition is a reorganization of the magnetite crystal structure occurring at a temperature T<sub>V</sub> in the range 80–125 K, where the room-temperature cubic inverse-spinel structure transforms to a monoclinic arrangement, and many physical properties of the mineral (e.g. electrical resistivity, heat capacity, magnetic susceptibility, remanence and coercivity) change significantly</p>
</div></blockquote>
<p>It is of interest to determine the Verwey transition temperature (T<sub>V</sub>) as it is highly sensitive to changes in magnetite stoichiometry associated with cation substitution or oxidation.</p>
<section id="estimating-the-verwey-transition-temperature">
<h3>Estimating the Verwey transition temperature<a class="headerlink" href="#estimating-the-verwey-transition-temperature" title="Link to this heading">#</a></h3>
<p>It is preferable to estimate the temperature of the Verwey transition (T<sub>V</sub>) associated with warming curves (e.g. the FC/ZFC data) than cooling curves. The rationale is that cooling curves also pass through the isotropic point at a temperature of ∼130 K prior to going through the Verwey transition. The loss of magnetization associated with going through the isotropic point can be very large (particularly for multidomain magnetites) which can obscure the Verwey transition (Jackson and Moskowitz, 2020).</p>
<p>We can apply the method described in Jackson and Moskowitz (2020) to estimate the temperature of the Verwey transition. In this method,</p>
<blockquote>
<div><p>[This approach] assumes that the loss of remanence on warming is due to the superposition of (1) progressive unblocking over the 20–300 K temperature range [e.g. due to the transition from the stable single-domain (SSD) to the superparamagnetic (SP) state in nanoparticle populations of magnetite or other magnetic phases] and (2) domain reorganization and intraparticle remanence rotation in a discrete temperature window around T<sub>V</sub>, due to the monoclinic-to-cubic transformation in magnetite.</p>
</div></blockquote>
<p>The method to estimate the temperature of the Verwey transition of Jackson and Moskowitz (2020) is to fit the derivative of the data outside of the Verwey transition and then subtract that fit from the derivative. This approach seeks to isolate the signal that is due to the Verwey transition. The peak of the derivative curve can then be used to estimate T<sub>V</sub>. This is done as the interpolated zero crossing of the derivative of the spectrum curve.</p>
<p>In the code cell below, we define the temperature and magnetization values that will be used for estimating T<sub>V</sub>. The following parameters can be adjusted:</p>
<p><code class="docutils literal notranslate"><span class="pre">t_range_background_min</span></code> and <code class="docutils literal notranslate"><span class="pre">t_range_background_max</span></code>: The temperature range over which the polynomial fit is applied to the background
<code class="docutils literal notranslate"><span class="pre">excluded_t_min</span></code> and <code class="docutils literal notranslate"><span class="pre">excluded_t_max</span></code>: The temperature range that is excluded from the background fit due to remanence loss associated with the Verwey transition.
<code class="docutils literal notranslate"><span class="pre">poly_deg</span></code>: the degree of the polynomial fit that is made to the background. Following Jackson and Moskowitz (2020), the default is set to be 3 (cubic).</p>
<p>As described in Jackson and Moskowitz (2020), these temperature ranges and polynomial degree can be adjusted to obtain ‘reasonable’ looking curves for the magnetite demagnetization and the progressive unblocking. The goal is for curves that are monotonic with and fits that are within the measurement noise, while seeking to minimizing the polynomial degree.</p>
</section>
</section>
<section id="interactively-fit-the-verwey-transition">
<h2>Interactively fit the Verwey transition<a class="headerlink" href="#interactively-fit-the-verwey-transition" title="Link to this heading">#</a></h2>
<p>First we need to pick the specimen and the experiment (FC or ZFC curve) to analyze.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimen_dropdown</span><span class="p">,</span> <span class="n">method_dropdown</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">interactive_verwey_specimen_method_selection</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7ce2aa76afe64e18a18f1d85fe739ffe", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Once a sample is selected, we can estimate the Verwey transition using the method described above. Adjust the sliders to change the range of the background that is being fit, the temperature range that is being excluded from the background fit, and the polynomial degree that is being used for the background fit.</p>
<p><em>Note: if you change the specimen or method in the dropdown menus above, rerun the code in the cell below to do the fit for the new specimen.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmag</span><span class="o">.</span><span class="n">interactive_verwey_estimate</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_dropdown</span><span class="p">,</span> <span class="n">method_dropdown</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5a5c8304ee7c43e8bf79ca65aecaff74", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f52a71a6c08647359991d833f89aba11", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="use-the-rmag-verwey-estimate-function">
<h2>Use the <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate</span></code> function<a class="headerlink" href="#use-the-rmag-verwey-estimate-function" title="Link to this heading">#</a></h2>
<p>The interactive widgets above are using the function <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate</span></code>. Rather than putting in the values using the interactive widgets, they can be specified and passed to the function. This approach is being taken in the code cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimen_name</span> <span class="o">=</span> <span class="s1">&#39;NED2-8c&#39;</span>
<span class="n">fc_data</span><span class="p">,</span> <span class="n">zfc_data</span><span class="p">,</span> <span class="n">rtsirm_cool_data</span><span class="p">,</span> <span class="n">rtsirm_warm_data</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">extract_mpms_data</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_name</span><span class="p">)</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span>
<span class="n">mags</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]</span>

<span class="c1">#Enter the minimum temperature for the background fit</span>
<span class="n">t_range_background_min</span> <span class="o">=</span> <span class="mi">55</span> 

<span class="c1">#Enter the maximum temperature for the background fit</span>
<span class="n">t_range_background_max</span> <span class="o">=</span> <span class="mi">250</span> 

<span class="c1">#Enter the minimum temperature to exclude from the background fit</span>
<span class="n">excluded_t_min</span> <span class="o">=</span> <span class="mi">75</span> 

<span class="c1">#Enter the maximum temperature to exclude from the background fit</span>
<span class="n">excluded_t_max</span> <span class="o">=</span> <span class="mi">150</span> 

<span class="c1">#The polynomial degree for the background fit can be adjusted (default is 3)</span>
<span class="n">poly_deg</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">verwey_estimate</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">verwey_estimate</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">mags</span><span class="p">,</span> 
                                       <span class="n">t_range_background_min</span><span class="p">,</span>
                                       <span class="n">t_range_background_max</span><span class="p">,</span>
                                       <span class="n">excluded_t_min</span><span class="p">,</span>
                                       <span class="n">excluded_t_max</span><span class="p">,</span>
                                       <span class="n">poly_deg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3a94f97d185b5e3bed5a7fd5cdb126c3b91f5e43be1b1ad6ee2c6fde41f84b6.png" src="_images/d3a94f97d185b5e3bed5a7fd5cdb126c3b91f5e43be1b1ad6ee2c6fde41f84b6.png" />
</div>
</div>
</section>
<section id="plot-the-second-derivative-curve">
<h2>Plot the second derivative curve<a class="headerlink" href="#plot-the-second-derivative-curve" title="Link to this heading">#</a></h2>
<p>The estimate of the Verwey transition calculated above uses second derivative and calculates where the second derivative crosses zero by interpolating from the points on either side of the peak in the first derivative. This calculation can be visualized by setting the parameter <code class="docutils literal notranslate"><span class="pre">plot_zero_crossing</span> <span class="pre">=</span> <span class="pre">True</span></code> which generates an additional plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">verwey_estimate</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">verwey_estimate</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">mags</span><span class="p">,</span> 
                                       <span class="n">t_range_background_min</span><span class="p">,</span>
                                       <span class="n">t_range_background_max</span><span class="p">,</span>
                                       <span class="n">excluded_t_min</span><span class="p">,</span>
                                       <span class="n">excluded_t_max</span><span class="p">,</span>
                                       <span class="n">poly_deg</span><span class="p">,</span>
                                       <span class="n">plot_zero_crossing</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dc04ca939d1d4aa2ec10da086acc265385a2a322251ccc425d49dc64376cfa03.png" src="_images/dc04ca939d1d4aa2ec10da086acc265385a2a322251ccc425d49dc64376cfa03.png" />
<img alt="_images/d3a94f97d185b5e3bed5a7fd5cdb126c3b91f5e43be1b1ad6ee2c6fde41f84b6.png" src="_images/d3a94f97d185b5e3bed5a7fd5cdb126c3b91f5e43be1b1ad6ee2c6fde41f84b6.png" />
</div>
</div>
</section>
<section id="determine-the-verwey-temperatures-for-additional-specimens">
<h2>Determine the Verwey temperatures for additional specimens<a class="headerlink" href="#determine-the-verwey-temperatures-for-additional-specimens" title="Link to this heading">#</a></h2>
<p>There are three more specimens with LT-SIRM data. Let’s plot those data and determine Verwey temperature estimates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimen_name</span> <span class="o">=</span> <span class="s1">&#39;NED18-2c&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">specimen_name</span><span class="p">)</span>
<span class="n">fc_data</span><span class="p">,</span> <span class="n">zfc_data</span><span class="p">,</span> <span class="n">rtsirm_cool_data</span><span class="p">,</span> <span class="n">rtsirm_warm_data</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">extract_mpms_data</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_name</span><span class="p">)</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span>
<span class="n">mags</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]</span>
<span class="n">verwey_estimate</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">verwey_estimate</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">mags</span><span class="p">,</span> 
                                       <span class="n">t_range_background_min</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                                       <span class="n">t_range_background_max</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                                       <span class="n">excluded_t_min</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                       <span class="n">excluded_t_max</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                                       <span class="n">poly_deg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                       <span class="n">plot_zero_crossing</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">specimen_name</span> <span class="o">=</span> <span class="s1">&#39;NED2-8c&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">specimen_name</span><span class="p">)</span>
<span class="n">fc_data</span><span class="p">,</span> <span class="n">zfc_data</span><span class="p">,</span> <span class="n">rtsirm_cool_data</span><span class="p">,</span> <span class="n">rtsirm_warm_data</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">extract_mpms_data</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_name</span><span class="p">)</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span>
<span class="n">mags</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]</span>
<span class="n">verwey_estimate</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">verwey_estimate</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">mags</span><span class="p">,</span> 
                                       <span class="n">t_range_background_min</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                                       <span class="n">t_range_background_max</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                                       <span class="n">excluded_t_min</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                       <span class="n">excluded_t_max</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                                       <span class="n">poly_deg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                       <span class="n">plot_zero_crossing</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">specimen_name</span> <span class="o">=</span> <span class="s1">&#39;NED2-8c&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">specimen_name</span><span class="p">)</span>
<span class="n">fc_data</span><span class="p">,</span> <span class="n">zfc_data</span><span class="p">,</span> <span class="n">rtsirm_cool_data</span><span class="p">,</span> <span class="n">rtsirm_warm_data</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">extract_mpms_data</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_name</span><span class="p">)</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span>
<span class="n">mags</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]</span>
<span class="n">verwey_estimate</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">verwey_estimate</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">mags</span><span class="p">,</span> 
                                       <span class="n">t_range_background_min</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                                       <span class="n">t_range_background_max</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                                       <span class="n">excluded_t_min</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                       <span class="n">excluded_t_max</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                                       <span class="n">poly_deg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                       <span class="n">plot_zero_crossing</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NED18-2c
</pre></div>
</div>
<img alt="_images/b46d512366ea21152a749a72222c56476c9c487dc540df144e5304bf564388d6.png" src="_images/b46d512366ea21152a749a72222c56476c9c487dc540df144e5304bf564388d6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NED2-8c
</pre></div>
</div>
<img alt="_images/2375ad635f80c28f4eced1c2bb176e7cc1e8be1e43a207899e5f8fb874f719a1.png" src="_images/2375ad635f80c28f4eced1c2bb176e7cc1e8be1e43a207899e5f8fb874f719a1.png" />
<img alt="_images/1946a80bad47d78b30dd8d764038e4a85fddea02c01825ba13e331278eb030fc.png" src="_images/1946a80bad47d78b30dd8d764038e4a85fddea02c01825ba13e331278eb030fc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NED2-8c
</pre></div>
</div>
<img alt="_images/bfb28017326a47907090586672e731bb62468862c636bdb8897b2f41828f1407.png" src="_images/bfb28017326a47907090586672e731bb62468862c636bdb8897b2f41828f1407.png" />
<img alt="_images/1946a80bad47d78b30dd8d764038e4a85fddea02c01825ba13e331278eb030fc.png" src="_images/1946a80bad47d78b30dd8d764038e4a85fddea02c01825ba13e331278eb030fc.png" />
<img alt="_images/bfb28017326a47907090586672e731bb62468862c636bdb8897b2f41828f1407.png" src="_images/bfb28017326a47907090586672e731bb62468862c636bdb8897b2f41828f1407.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MPMS_plot.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">MPMS data visualization</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-scientific-python-libraries">Import scientific python libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-measurements">Import measurements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background-on-the-verwey-transition">Background on the Verwey transition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-verwey-transition-temperature">Estimating the Verwey transition temperature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactively-fit-the-verwey-transition">Interactively fit the Verwey transition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-rmag-verwey-estimate-function">Use the <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate</span></code> function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-second-derivative-curve">Plot the second derivative curve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-the-verwey-temperatures-for-additional-specimens">Determine the Verwey temperatures for additional specimens</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By RockmagPy Contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>