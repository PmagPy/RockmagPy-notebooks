
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Estimate the Verwey transition temperature &#8212; RockmagPy Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MPMS_verwey_fit';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fit and remove the goethite component" href="MPMS_goethite_fit.html" />
    <link rel="prev" title="Plot MPMS data (AC susceptibility)" href="MPMS_plot_ac.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="book/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/rockmagpy.png" class="logo__image only-light" alt="RockmagPy Documentation - Home"/>
    <script>document.write(`<img src="_static/rockmagpy.png" class="logo__image only-dark" alt="RockmagPy Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="book/intro.html">
                    RockmagPy: tools for rock magnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Nuts &amp; Bolts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rockmag_set_up.html">Getting going with rockmag.py on JupyterHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="rockmag_data_unpack.html">Rock magnetic experiments data import</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MPMS notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot_dc.html">Plot MPMS data (DC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot_ac.html">Plot MPMS data (AC susceptibility)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Estimate the Verwey transition temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_goethite_fit.html">Fit and remove the goethite component</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">VSM notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="VSM_backfield_unmixing.html">Unmixing coercivity spectra from backfield curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermomagnetic notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="high_T_susceptibility.html">Analysis of susceptibility-temperature, <span style="font-family: 'Times New Roman';"><em>(Kappabridge <span class="math notranslate nohighlight">\(\chi\)</span>-T)</em></span>, data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Anisotropy notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Anisotropy_plot_AMS.html">Plot and analyze anisotropy data (AMS)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hysteresis loop notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="hysteresis_processing.html">Hysteresis Processing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="book/background/low_temperature_behavior.html">Low temperature behavior</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="book/background/morin.html">Morin transition</a></li>
<li class="toctree-l2"><a class="reference internal" href="book/minerals/siderite.html">Siderite</a></li>
<li class="toctree-l2"><a class="reference internal" href="book/background/paramagnetism.html">Paramagnetism</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">More resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/resources.html">Resources for learning more about rock magnetism</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks/issues/new?title=Issue%20on%20page%20%2FMPMS_verwey_fit.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MPMS_verwey_fit.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Estimate the Verwey transition temperature</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-scientific-python-libraries">Import scientific python libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-data">Import data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background-on-the-verwey-transition">Background on the Verwey transition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-verwey-transition-temperature">Estimating the Verwey transition temperature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactively-fit-the-verwey-transition">Interactively fit the Verwey transition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-rmag-verwey-estimate-function">Use the <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate</span></code> function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-second-derivative-curve">Plot the second derivative curve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-and-record-the-verwey-temperatures-for-multiple-specimens">Determine and record the Verwey temperatures for multiple specimens</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-these-verwey-estimates-to-the-specimens-magic-table">Add these Verwey estimates to the specimens MagIC table</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="estimate-the-verwey-transition-temperature">
<h1>Estimate the Verwey transition temperature<a class="headerlink" href="#estimate-the-verwey-transition-temperature" title="Link to this heading">#</a></h1>
<p>This notebook demonstrates how to estimate the temperature of the Verwey transition from remanence upon warming curves developed through MPMS experiments.</p>
<section id="import-scientific-python-libraries">
<h2>Import scientific python libraries<a class="headerlink" href="#import-scientific-python-libraries" title="Link to this heading">#</a></h2>
<p>Run the cell below to import the functions needed for the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pmagpy.rockmag</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rmag</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pmagpy.contribution_builder</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cb</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pmagpy.ipmag</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ipmag</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-data">
<h2>Import data<a class="headerlink" href="#import-data" title="Link to this heading">#</a></h2>
<p>We can take the same approach as in the <code class="docutils literal notranslate"><span class="pre">rockmag_data_unpack.ipynb</span></code> notebook to bring the MagIC data into the notebook as a Contribution. To bring in a different contribution, set the directory path (currently <code class="docutils literal notranslate"><span class="pre">'./example_data/ECMB'</span></code>) and the name of the file (currently <code class="docutils literal notranslate"><span class="pre">'ECMB</span> <span class="pre">2018.TXT'</span></code>) to be those relevant to your data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the dir_path to the directory where the measurements.txt file is located</span>
<span class="n">dir_path</span> <span class="o">=</span> <span class="s1">&#39;./example_data/ECMB&#39;</span>

<span class="c1"># set the name of the MagIC file</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">unpack_magic</span><span class="p">(</span><span class="s1">&#39;ECMB 2018.TXT&#39;</span><span class="p">,</span> 
                     <span class="n">dir_path</span> <span class="o">=</span> <span class="n">dir_path</span><span class="p">,</span>
                     <span class="n">input_dir_path</span> <span class="o">=</span> <span class="n">dir_path</span><span class="p">)</span>

<span class="c1"># create a contribution object from the tables in the directory</span>
<span class="n">contribution</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">Contribution</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
<span class="n">measurements</span> <span class="o">=</span> <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;measurements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>working on:  &#39;contribution\r&#39;
1  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/contribution.txt
  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/contribution.txt
working on:  &#39;specimens\r&#39;
15  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/specimens.txt
  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/specimens.txt
working on:  &#39;samples\r&#39;
5  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/samples.txt
  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/samples.txt
working on:  &#39;sites\r&#39;
5  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/sites.txt
  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/sites.txt
working on:  &#39;locations\r&#39;
10  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/locations.txt
  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/locations.txt
working on:  &#39;measurements\r&#39;
5018  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/measurements.txt
  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/measurements.txt
-I- Using online data model
-I- Getting method codes from earthref.org
-I- Importing controlled vocabularies from https://earthref.org
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define these three parameters to match your data</span>
<span class="n">magic_id</span> <span class="o">=</span> <span class="s1">&#39;20213&#39;</span>
<span class="n">dir_path</span> <span class="o">=</span> <span class="s1">&#39;example_data/ECMB&#39;</span>

<span class="n">result</span><span class="p">,</span> <span class="n">magic_file</span> <span class="o">=</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">download_magic_from_id</span><span class="p">(</span><span class="n">magic_id</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">dir_path</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">unpack_magic</span><span class="p">(</span><span class="n">magic_file</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">)</span>
<span class="n">contribution</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">Contribution</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
<span class="n">measurements</span> <span class="o">=</span> <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;measurements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span>
<span class="n">measurements</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download successful. File saved to: example_data/ECMB/magic_contribution_20213.txt
working on:  &#39;contribution&#39;
1  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/contribution.txt
contribution  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/contribution.txt
working on:  &#39;locations&#39;
1  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/locations.txt
locations  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/locations.txt
working on:  &#39;sites&#39;
90  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/sites.txt
sites  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/sites.txt
working on:  &#39;samples&#39;
312  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/samples.txt
samples  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/samples.txt
working on:  &#39;specimens&#39;
1574  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/specimens.txt
specimens  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/specimens.txt
working on:  &#39;measurements&#39;
17428  records written to file  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/measurements.txt
measurements  data put in  /Users/penokean/0000_GitHub/RockmagPy-notebooks/example_data/ECMB/measurements.txt
-I- Using online data model
-I- Getting method codes from earthref.org
-I- Importing controlled vocabularies from https://earthref.org
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>citations</th>
      <th>dir_csd</th>
      <th>dir_dec</th>
      <th>dir_inc</th>
      <th>experiment</th>
      <th>instrument_codes</th>
      <th>magn_mass</th>
      <th>magn_moment</th>
      <th>magn_r2_det</th>
      <th>magn_x_sigma</th>
      <th>magn_y_sigma</th>
      <th>magn_z_sigma</th>
      <th>meas_field_dc</th>
      <th>meas_n_orient</th>
      <th>meas_temp</th>
      <th>measurement</th>
      <th>method_codes</th>
      <th>quality</th>
      <th>sequence</th>
      <th>software_packages</th>
      <th>specimen</th>
      <th>standard</th>
      <th>timestamp</th>
      <th>treat_ac_field</th>
      <th>treat_dc_field</th>
      <th>treat_dc_field_phi</th>
      <th>treat_dc_field_theta</th>
      <th>treat_step_num</th>
      <th>treat_temp</th>
    </tr>
    <tr>
      <th>measurement name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NED12-1b_LP-DIR-AF-1</th>
      <td>This study</td>
      <td>3.9</td>
      <td>82.8</td>
      <td>84.9</td>
      <td>NED12-1b_LP-DIR-AF</td>
      <td>hargrave 2018-10-13 20:48:41</td>
      <td>NaN</td>
      <td>0.000003</td>
      <td>NaN</td>
      <td>1.230000e-07</td>
      <td>1.320000e-07</td>
      <td>3.250000e-08</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>273.0000</td>
      <td>NED12-1b_LP-DIR-AF-1</td>
      <td>LT-NO:LP-DIR-AF</td>
      <td>g</td>
      <td>1</td>
      <td>pmagpy-4.2.28</td>
      <td>NED12-1b</td>
      <td>u</td>
      <td>None</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>NED12-1b_LP-DIR-AF-2</th>
      <td>This study</td>
      <td>3.8</td>
      <td>86.8</td>
      <td>84.8</td>
      <td>NED12-1b_LP-DIR-AF</td>
      <td>hargrave 2018-10-13 20:50:06</td>
      <td>NaN</td>
      <td>0.000003</td>
      <td>NaN</td>
      <td>1.200000e-07</td>
      <td>1.290000e-07</td>
      <td>3.210000e-08</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>273.0000</td>
      <td>NED12-1b_LP-DIR-AF-2</td>
      <td>LT-AF-Z:LP-DIR-AF</td>
      <td>g</td>
      <td>2</td>
      <td>pmagpy-4.2.28</td>
      <td>NED12-1b</td>
      <td>u</td>
      <td>None</td>
      <td>0.001</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>NED12-1b_LP-DIR-AF-3</th>
      <td>This study</td>
      <td>3.8</td>
      <td>87.7</td>
      <td>85.4</td>
      <td>NED12-1b_LP-DIR-AF</td>
      <td>hargrave 2018-10-13 20:51:28</td>
      <td>NaN</td>
      <td>0.000003</td>
      <td>NaN</td>
      <td>1.210000e-07</td>
      <td>1.270000e-07</td>
      <td>3.210000e-08</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>273.0000</td>
      <td>NED12-1b_LP-DIR-AF-3</td>
      <td>LT-AF-Z:LP-DIR-AF</td>
      <td>g</td>
      <td>3</td>
      <td>pmagpy-4.2.28</td>
      <td>NED12-1b</td>
      <td>u</td>
      <td>None</td>
      <td>0.002</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>NED12-1b_LP-DIR-AF-4</th>
      <td>This study</td>
      <td>3.8</td>
      <td>90.2</td>
      <td>86.3</td>
      <td>NED12-1b_LP-DIR-AF</td>
      <td>hargrave 2018-10-13 20:52:53</td>
      <td>NaN</td>
      <td>0.000003</td>
      <td>NaN</td>
      <td>1.190000e-07</td>
      <td>1.250000e-07</td>
      <td>3.230000e-08</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>273.0000</td>
      <td>NED12-1b_LP-DIR-AF-4</td>
      <td>LT-AF-Z:LP-DIR-AF</td>
      <td>g</td>
      <td>4</td>
      <td>pmagpy-4.2.28</td>
      <td>NED12-1b</td>
      <td>u</td>
      <td>None</td>
      <td>0.003</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>NED12-1b_LP-DIR-AF-5</th>
      <td>This study</td>
      <td>3.8</td>
      <td>98.8</td>
      <td>87.7</td>
      <td>NED12-1b_LP-DIR-AF</td>
      <td>hargrave 2018-10-13 20:54:18</td>
      <td>NaN</td>
      <td>0.000003</td>
      <td>NaN</td>
      <td>1.170000e-07</td>
      <td>1.210000e-07</td>
      <td>3.270000e-08</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>273.0000</td>
      <td>NED12-1b_LP-DIR-AF-5</td>
      <td>LT-AF-Z:LP-DIR-AF</td>
      <td>g</td>
      <td>5</td>
      <td>pmagpy-4.2.28</td>
      <td>NED12-1b</td>
      <td>u</td>
      <td>None</td>
      <td>0.004</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-54</th>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024</td>
      <td>IRM-OldBlue</td>
      <td>0.001620</td>
      <td>NaN</td>
      <td>0.987706</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>280.6299</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-54</td>
      <td>LP-CW-SIRM:LP-MW</td>
      <td>g</td>
      <td>17424</td>
      <td>None</td>
      <td>NED4-1c</td>
      <td>u</td>
      <td>2020:01:07:02:57:44.861</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-55</th>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024</td>
      <td>IRM-OldBlue</td>
      <td>0.001602</td>
      <td>NaN</td>
      <td>0.987589</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>285.5181</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-55</td>
      <td>LP-CW-SIRM:LP-MW</td>
      <td>g</td>
      <td>17425</td>
      <td>None</td>
      <td>NED4-1c</td>
      <td>u</td>
      <td>2020:01:07:02:58:43.41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-56</th>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024</td>
      <td>IRM-OldBlue</td>
      <td>0.001584</td>
      <td>NaN</td>
      <td>0.987507</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>290.5842</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-56</td>
      <td>LP-CW-SIRM:LP-MW</td>
      <td>g</td>
      <td>17426</td>
      <td>None</td>
      <td>NED4-1c</td>
      <td>u</td>
      <td>2020:01:07:02:59:43.312</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-57</th>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024</td>
      <td>IRM-OldBlue</td>
      <td>0.001566</td>
      <td>NaN</td>
      <td>0.987632</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>295.6190</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-57</td>
      <td>LP-CW-SIRM:LP-MW</td>
      <td>g</td>
      <td>17427</td>
      <td>None</td>
      <td>NED4-1c</td>
      <td>u</td>
      <td>2020:01:07:03:00:42.762</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-58</th>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024</td>
      <td>IRM-OldBlue</td>
      <td>0.001534</td>
      <td>NaN</td>
      <td>0.987948</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>300.0338</td>
      <td>NED4-1c-LP-CW-SIRM:LP-MW-DC-13024-3-58</td>
      <td>LP-CW-SIRM:LP-MW</td>
      <td>g</td>
      <td>17428</td>
      <td>None</td>
      <td>NED4-1c</td>
      <td>u</td>
      <td>2020:01:07:03:07:06.72</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>17428 rows × 29 columns</p>
</div></div></div>
</div>
</section>
<section id="background-on-the-verwey-transition">
<h2>Background on the Verwey transition<a class="headerlink" href="#background-on-the-verwey-transition" title="Link to this heading">#</a></h2>
<p>The example data used here was collected from mafic dikes in the East Central Minnesota batholith and the specimens exhibit a significant loss of remanence across the Verwey transition. The Verwey transition as defined by Jackson and Moskowitz (<a class="reference external" href="https://doi.org/10.1093/gji/ggaa516">2020</a>) is:</p>
<blockquote>
<div><p>The Verwey transition is a reorganization of the magnetite crystal structure occurring at a temperature T<sub>V</sub> in the range 80–125 K, where the room-temperature cubic inverse-spinel structure transforms to a monoclinic arrangement, and many physical properties of the mineral (e.g. electrical resistivity, heat capacity, magnetic susceptibility, remanence and coercivity) change significantly.</p>
</div></blockquote>
<p>It is of interest to determine the Verwey transition temperature (T<sub>V</sub>) as it is highly sensitive to changes in magnetite stoichiometry associated with cation substitution or oxidation.</p>
<section id="estimating-the-verwey-transition-temperature">
<h3>Estimating the Verwey transition temperature<a class="headerlink" href="#estimating-the-verwey-transition-temperature" title="Link to this heading">#</a></h3>
<p>It is preferable to estimate the temperature of the Verwey transition (T<sub>V</sub>) associated with warming curves (e.g. the FC/ZFC data) than cooling curves. The rationale is that cooling curves also pass through the isotropic point at a temperature of ∼130 K prior to going through the Verwey transition. The loss of magnetization associated with going through the isotropic point can be very large (particularly for multidomain magnetites) which can obscure the Verwey transition (<a class="reference external" href="https://doi.org/10.1093/gji/ggaa516">Jackson and Moskowitz, 2020</a>).</p>
<p>We can apply the method described in Jackson and Moskowitz (<a class="reference external" href="https://doi.org/10.1093/gji/ggaa516">2020</a>) to estimate the temperature of the Verwey transition. In this method,</p>
<blockquote>
<div><p>[This approach] assumes that the loss of remanence on warming is due to the superposition of (1) progressive unblocking over the 20–300 K temperature range [e.g. due to the transition from the stable single-domain (SSD) to the superparamagnetic (SP) state in nanoparticle populations of magnetite or other magnetic phases] and (2) domain reorganization and intraparticle remanence rotation in a discrete temperature window around T<sub>V</sub>, due to the monoclinic-to-cubic transformation in magnetite.</p>
</div></blockquote>
<p>The method to estimate the temperature of the Verwey transition of Jackson and Moskowitz (<a class="reference external" href="https://doi.org/10.1093/gji/ggaa516">2020</a>) is to fit the derivative of the data outside of the Verwey transition and then subtract that fit from the derivative. This approach seeks to isolate the signal that is due to the Verwey transition. The peak of the derivative curve can then be used to estimate T<sub>V</sub>. This is done as the interpolated zero-crossing of the derivative of the spectrum curve.</p>
<p>In the code cell below, we define the temperature and magnetization values that will be used for estimating T<sub>V</sub>. The following parameters can be adjusted:</p>
<p><code class="docutils literal notranslate"><span class="pre">t_range_background_min</span></code> and <code class="docutils literal notranslate"><span class="pre">t_range_background_max</span></code>: The temperature range over which the polynomial fit is applied to the background
<code class="docutils literal notranslate"><span class="pre">excluded_t_min</span></code> and <code class="docutils literal notranslate"><span class="pre">excluded_t_max</span></code>: The temperature range that is excluded from the background fit due to remanence loss associated with the Verwey transition.
<code class="docutils literal notranslate"><span class="pre">poly_deg</span></code>: the degree of the polynomial fit that is made to the background. Following Jackson and Moskowitz (<a class="reference external" href="https://doi.org/10.1093/gji/ggaa516">2020</a>), the default is set to be 3 (cubic).</p>
<p>As described in Jackson and Moskowitz (<a class="reference external" href="https://doi.org/10.1093/gji/ggaa516">2020</a>), these temperature ranges and polynomial degree can be adjusted to obtain ‘reasonable’ looking curves for the magnetite demagnetization and the progressive unblocking. The goal is for curves that are monotonic with and fits that are within the measurement noise, while seeking to minimizing the polynomial degree.</p>
</section>
</section>
<section id="interactively-fit-the-verwey-transition">
<h2>Interactively fit the Verwey transition<a class="headerlink" href="#interactively-fit-the-verwey-transition" title="Link to this heading">#</a></h2>
<p>First we need to pick the specimen and the experiment (FC or ZFC curve) to analyze.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimen_dropdown</span><span class="p">,</span> <span class="n">method_dropdown</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">interactive_verwey_specimen_method_selection</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c65eab55eaf54669be27a32d109d00d5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Once a sample is selected, we can estimate the Verwey transition using the method described above. Adjust the sliders to change the range of the background that is being fit, the temperature range that is being excluded from the background fit, and the polynomial degree that is being used for the background fit.</p>
<p><em>Note: if you change the specimen or method in the dropdown menus above, rerun the code in the cell below to do the fit for the new specimen.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmag</span><span class="o">.</span><span class="n">interactive_verwey_estimate</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_dropdown</span><span class="p">,</span> <span class="n">method_dropdown</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c6bfdbe77932407dae416a4d7898c217", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cab1c9f0f4f24346a7d767b3929fecf4", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="use-the-rmag-verwey-estimate-function">
<h2>Use the <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate</span></code> function<a class="headerlink" href="#use-the-rmag-verwey-estimate-function" title="Link to this heading">#</a></h2>
<p>The interactive widgets above are using the function <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate</span></code>. Rather than putting in the values using the interactive widgets, they can be specified and passed to the function. This approach is being taken in the code cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimen_name</span> <span class="o">=</span> <span class="s1">&#39;NED2-8c&#39;</span>
<span class="n">fc_data</span><span class="p">,</span> <span class="n">zfc_data</span><span class="p">,</span> <span class="n">rtsirm_cool_data</span><span class="p">,</span> <span class="n">rtsirm_warm_data</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">extract_mpms_data</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_name</span><span class="p">)</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span>
<span class="n">mags</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]</span>

<span class="c1">#Enter the minimum temperature for the background fit</span>
<span class="n">t_range_background_min</span> <span class="o">=</span> <span class="mi">55</span> 

<span class="c1">#Enter the maximum temperature for the background fit</span>
<span class="n">t_range_background_max</span> <span class="o">=</span> <span class="mi">250</span> 

<span class="c1">#Enter the minimum temperature to exclude from the background fit</span>
<span class="n">excluded_t_min</span> <span class="o">=</span> <span class="mi">75</span> 

<span class="c1">#Enter the maximum temperature to exclude from the background fit</span>
<span class="n">excluded_t_max</span> <span class="o">=</span> <span class="mi">150</span> 

<span class="c1">#The polynomial degree for the background fit can be adjusted (default is 3)</span>
<span class="n">poly_deg</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">verwey_estimate</span><span class="p">,</span> <span class="n">remanence_loss</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">verwey_estimate</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">mags</span><span class="p">,</span> 
                                       <span class="n">t_range_background_min</span><span class="p">,</span>
                                       <span class="n">t_range_background_max</span><span class="p">,</span>
                                       <span class="n">excluded_t_min</span><span class="p">,</span>
                                       <span class="n">excluded_t_max</span><span class="p">,</span>
                                       <span class="n">poly_deg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/fa73659342d65d28fff3a49380a9eb0480eeea1311550f84c1fbea972af4e097.png"><img alt="_images/fa73659342d65d28fff3a49380a9eb0480eeea1311550f84c1fbea972af4e097.png" src="_images/fa73659342d65d28fff3a49380a9eb0480eeea1311550f84c1fbea972af4e097.png" style="width: 1005px; height: 463px;" />
</a>
</div>
</div>
</section>
<section id="plot-the-second-derivative-curve">
<h2>Plot the second derivative curve<a class="headerlink" href="#plot-the-second-derivative-curve" title="Link to this heading">#</a></h2>
<p>The estimate of the Verwey transition calculated above uses second derivative and calculates where the second derivative crosses zero by interpolating from the points on either side of the peak in the first derivative. This calculation can be visualized by setting the parameter <code class="docutils literal notranslate"><span class="pre">plot_zero_crossing</span> <span class="pre">=</span> <span class="pre">True</span></code> which generates an additional plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimen_name</span> <span class="o">=</span> <span class="s1">&#39;NED2-8c&#39;</span>
<span class="n">fc_data</span><span class="p">,</span> <span class="n">zfc_data</span><span class="p">,</span> <span class="n">rtsirm_cool_data</span><span class="p">,</span> <span class="n">rtsirm_warm_data</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">extract_mpms_data</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_name</span><span class="p">)</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span>
<span class="n">mags</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]</span>

<span class="n">verwey_estimate</span><span class="p">,</span> <span class="n">remanence_loss</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">verwey_estimate</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">mags</span><span class="p">,</span> 
                                       <span class="n">t_range_background_min</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                                       <span class="n">t_range_background_max</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                                       <span class="n">excluded_t_min</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                       <span class="n">excluded_t_max</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                                       <span class="n">poly_deg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                       <span class="n">plot_zero_crossing</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1946a80bad47d78b30dd8d764038e4a85fddea02c01825ba13e331278eb030fc.png"><img alt="_images/1946a80bad47d78b30dd8d764038e4a85fddea02c01825ba13e331278eb030fc.png" src="_images/1946a80bad47d78b30dd8d764038e4a85fddea02c01825ba13e331278eb030fc.png" style="width: 1014px; height: 386px;" />
</a>
<a class="reference internal image-reference" href="_images/5aec23f2ec096d007bb1c68c1edf008daad5bce028c73e557b583722767d2d75.png"><img alt="_images/5aec23f2ec096d007bb1c68c1edf008daad5bce028c73e557b583722767d2d75.png" src="_images/5aec23f2ec096d007bb1c68c1edf008daad5bce028c73e557b583722767d2d75.png" style="width: 1005px; height: 463px;" />
</a>
</div>
</div>
</section>
<section id="determine-and-record-the-verwey-temperatures-for-multiple-specimens">
<h2>Determine and record the Verwey temperatures for multiple specimens<a class="headerlink" href="#determine-and-record-the-verwey-temperatures-for-multiple-specimens" title="Link to this heading">#</a></h2>
<p>There are three specimens with LT-SIRM data. Let’s plot the data for each specimen and estimate the Verwey temperature for each. We want to be able to record all of the parameters along with the estimated Verwey transition.</p>
<p>We will take the following approach:</p>
<ul class="simple">
<li><p>define a list of dictionaries each containing the specimen name and its parameters for the fit (more specimens code be added by making additional dictionaries within the list). (<em>Note that if you use the ZFC experiment rather than the FC, the method code should be changed to LP-ZFC. SM-1DMAX denotes that the peak of the first derivative was used to make the fit</em>).</p></li>
<li><p>go through each specimen and make the fit using the <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate()</span> <span class="pre">function</span></code> while recording the parameters and the estimated temperature.</p></li>
<li><p>make the recorded parameters into a Dataframe</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a list of dictionaries, each containing the specimen name and its unique parameters</span>
<span class="n">specimens_with_params</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;specimen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;NED18-2c&#39;</span><span class="p">,</span>
        <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;t_range_background_min&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
            <span class="s1">&#39;t_range_background_max&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span>
            <span class="s1">&#39;excluded_t_min&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
            <span class="s1">&#39;excluded_t_max&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
            <span class="s1">&#39;poly_deg&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;method_codes&#39;</span><span class="p">:</span> <span class="s1">&#39;SM-1DMAX:LP-FC&#39;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;specimen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;NED2-8c&#39;</span><span class="p">,</span>
        <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;t_range_background_min&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
            <span class="s1">&#39;t_range_background_max&#39;</span><span class="p">:</span> <span class="mi">260</span><span class="p">,</span>
            <span class="s1">&#39;excluded_t_min&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
            <span class="s1">&#39;excluded_t_max&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
            <span class="s1">&#39;poly_deg&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;method_codes&#39;</span><span class="p">:</span> <span class="s1">&#39;SM-1DMAX:LP-FC&#39;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;specimen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;NED4-1c&#39;</span><span class="p">,</span>
        <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;t_range_background_min&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
            <span class="s1">&#39;t_range_background_max&#39;</span><span class="p">:</span> <span class="mi">260</span><span class="p">,</span>
            <span class="s1">&#39;excluded_t_min&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span>
            <span class="s1">&#39;excluded_t_max&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
            <span class="s1">&#39;poly_deg&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;method_codes&#39;</span><span class="p">:</span> <span class="s1">&#39;SM-1DMAX:LP-FC&#39;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="c1"># Initialize an empty list to store Verwey transition estimates along with parameters</span>
<span class="n">verwey_estimates_and_params</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Process each specimen with its unique parameters</span>
<span class="k">for</span> <span class="n">specimen</span> <span class="ow">in</span> <span class="n">specimens_with_params</span><span class="p">:</span>
    <span class="n">specimen_name</span> <span class="o">=</span> <span class="n">specimen</span><span class="p">[</span><span class="s1">&#39;specimen_name&#39;</span><span class="p">]</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">specimen</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]</span>
    
    <span class="n">fc_data</span><span class="p">,</span> <span class="n">zfc_data</span><span class="p">,</span> <span class="n">rtsirm_cool_data</span><span class="p">,</span> <span class="n">rtsirm_warm_data</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">extract_mpms_data</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="n">specimen_name</span><span class="p">)</span>
    <span class="n">temps</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span>
    <span class="n">mags</span> <span class="o">=</span> <span class="n">fc_data</span><span class="p">[</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]</span>
    
    <span class="n">verwey_estimate</span><span class="p">,</span> <span class="n">rem_loss</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">verwey_estimate</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">mags</span><span class="p">,</span> 
                                           <span class="n">t_range_background_min</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;t_range_background_min&#39;</span><span class="p">],</span>
                                           <span class="n">t_range_background_max</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;t_range_background_max&#39;</span><span class="p">],</span>
                                           <span class="n">excluded_t_min</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;excluded_t_min&#39;</span><span class="p">],</span>
                                           <span class="n">excluded_t_max</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;excluded_t_max&#39;</span><span class="p">],</span>
                                           <span class="n">poly_deg</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;poly_deg&#39;</span><span class="p">],</span>
                                           <span class="n">plot_title</span><span class="o">=</span><span class="n">specimen_name</span><span class="p">)</span>
    <span class="c1"># Append the specimen name, Verwey estimate, and all parameters to the list</span>
    <span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;specimen&#39;</span><span class="p">:</span> <span class="n">specimen_name</span><span class="p">,</span> <span class="s1">&#39;critical_temp&#39;</span><span class="p">:</span> <span class="n">verwey_estimate</span><span class="p">,</span> 
              <span class="s1">&#39;critical_temp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;Verwey&#39;</span><span class="p">}</span>
    <span class="n">record</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>  <span class="c1"># Merge the parameters with the record</span>
    <span class="n">verwey_estimates_and_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
    
<span class="n">verwey_estimates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">verwey_estimates_and_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/bacf6da46b9f6c7afca1a4d68b92c5c53bfa11651e70b1d3943c545ac7d76592.png"><img alt="_images/bacf6da46b9f6c7afca1a4d68b92c5c53bfa11651e70b1d3943c545ac7d76592.png" src="_images/bacf6da46b9f6c7afca1a4d68b92c5c53bfa11651e70b1d3943c545ac7d76592.png" style="width: 1014px; height: 469px;" />
</a>
<a class="reference internal image-reference" href="_images/7b1788ce9fe09f4fe4a9dff5cafa75489c383b994a705e642620e3c77797b01b.png"><img alt="_images/7b1788ce9fe09f4fe4a9dff5cafa75489c383b994a705e642620e3c77797b01b.png" src="_images/7b1788ce9fe09f4fe4a9dff5cafa75489c383b994a705e642620e3c77797b01b.png" style="width: 1005px; height: 469px;" />
</a>
<a class="reference internal image-reference" href="_images/edb9c39964f7c6204672a3401190a627a5cb570565c02860575e536ccd56e6ab.png"><img alt="_images/edb9c39964f7c6204672a3401190a627a5cb570565c02860575e536ccd56e6ab.png" src="_images/edb9c39964f7c6204672a3401190a627a5cb570565c02860575e536ccd56e6ab.png" style="width: 992px; height: 469px;" />
</a>
</div>
</div>
<p>We can now have a look at Verwey estimate that have been recorded:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">verwey_estimates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>specimen</th>
      <th>critical_temp</th>
      <th>critical_temp_type</th>
      <th>t_range_background_min</th>
      <th>t_range_background_max</th>
      <th>excluded_t_min</th>
      <th>excluded_t_max</th>
      <th>poly_deg</th>
      <th>method_codes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NED18-2c</td>
      <td>105.861068</td>
      <td>Verwey</td>
      <td>60</td>
      <td>250</td>
      <td>75</td>
      <td>150</td>
      <td>3</td>
      <td>SM-1DMAX:LP-FC</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NED2-8c</td>
      <td>116.145701</td>
      <td>Verwey</td>
      <td>60</td>
      <td>260</td>
      <td>75</td>
      <td>150</td>
      <td>3</td>
      <td>SM-1DMAX:LP-FC</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NED4-1c</td>
      <td>117.902959</td>
      <td>Verwey</td>
      <td>60</td>
      <td>260</td>
      <td>75</td>
      <td>150</td>
      <td>3</td>
      <td>SM-1DMAX:LP-FC</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="add-these-verwey-estimates-to-the-specimens-magic-table">
<h2>Add these Verwey estimates to the specimens MagIC table<a class="headerlink" href="#add-these-verwey-estimates-to-the-specimens-magic-table" title="Link to this heading">#</a></h2>
<p>We can now go through and update the specimens table with these Verwey estimates. To do this, we will take the following steps:</p>
<ul class="simple">
<li><p>add all the details about the Verwey fit into the description column</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">verwey_estimates_and_params</span><span class="p">)):</span>

    <span class="n">entry</span> <span class="o">=</span> <span class="n">verwey_estimates_and_params</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    
    <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;calculated using MPMS_verwey_fit.ipynb with parameters&#39;</span>
    
    <span class="c1"># Specify the keys to append to the description and then remove</span>
    <span class="n">keys_to_include</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;t_range_background_min&#39;</span><span class="p">,</span>
        <span class="s1">&#39;t_range_background_max&#39;</span><span class="p">,</span>
        <span class="s1">&#39;excluded_t_min&#39;</span><span class="p">,</span>
        <span class="s1">&#39;excluded_t_max&#39;</span><span class="p">,</span>
        <span class="s1">&#39;poly_deg&#39;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="c1"># Update the description by appending selected key-value pairs</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys_to_include</span><span class="p">:</span>
        <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">entry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="c1"># Remove the keys that were added to the description</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys_to_include</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">entry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
     
    <span class="n">df</span> <span class="o">=</span> <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;specimens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">],</span> <span class="s1">&#39;sample&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">],</span> <span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
    <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
    
    <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;specimens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">],</span><span class="n">verwey_estimates_and_params</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;specimens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>citations</th>
      <th>critical_temp</th>
      <th>critical_temp_type</th>
      <th>description</th>
      <th>dir_comp</th>
      <th>dir_dang</th>
      <th>dir_dec</th>
      <th>dir_inc</th>
      <th>dir_mad_free</th>
      <th>dir_n_comps</th>
      <th>dir_n_measurements</th>
      <th>dir_tilt_correction</th>
      <th>experiments</th>
      <th>hyst_bc</th>
      <th>hyst_bc_offset</th>
      <th>hyst_bcr</th>
      <th>hyst_mr_mass</th>
      <th>hyst_ms_mass</th>
      <th>hyst_xhf</th>
      <th>instrument_codes</th>
      <th>int_corr</th>
      <th>meas_orient_phi</th>
      <th>meas_orient_theta</th>
      <th>meas_step_max</th>
      <th>meas_step_min</th>
      <th>meas_step_unit</th>
      <th>meas_temp</th>
      <th>method_codes</th>
      <th>rem_hirm_mass</th>
      <th>rem_sratio</th>
      <th>rem_sratio_back</th>
      <th>rem_sratio_forward</th>
      <th>result_quality</th>
      <th>sample</th>
      <th>software_packages</th>
      <th>specimen</th>
      <th>volume</th>
      <th>weight</th>
    </tr>
    <tr>
      <th>specimen name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NED1-1b</th>
      <td>This study</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>mc</td>
      <td>2.8</td>
      <td>159.7</td>
      <td>62.5</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>-1.0</td>
      <td>NED1-1b_LP-DIR-AF</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>hargrave 2018-09-21 18:45:36</td>
      <td>u</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.04</td>
      <td>0.025</td>
      <td>T</td>
      <td>NaN</td>
      <td>LP-DIR-AF:DE-BFL:DA-DIR</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>g</td>
      <td>NED1-1</td>
      <td>pmagpy-4.2.25: demag_gui</td>
      <td>NED1-1b</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED1-1b</th>
      <td>This study</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>mc</td>
      <td>2.8</td>
      <td>139.2</td>
      <td>74.1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>NED1-1b_LP-DIR-AF</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>hargrave 2018-09-21 18:45:36</td>
      <td>u</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.04</td>
      <td>0.025</td>
      <td>T</td>
      <td>NaN</td>
      <td>LP-DIR-AF:DE-BFL:DA-DIR-GEO</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>g</td>
      <td>NED1-1</td>
      <td>pmagpy-4.2.25: demag_gui</td>
      <td>NED1-1b</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED1-1b</th>
      <td>This study</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>LP-NOMAG</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NED1-1</td>
      <td>None</td>
      <td>NED1-1b</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED1-2b</th>
      <td>This study</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>mc</td>
      <td>3.4</td>
      <td>164.1</td>
      <td>66.9</td>
      <td>0.4</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>-1.0</td>
      <td>NED1-2b_LP-DIR-AF</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>hargrave 2018-09-21 19:30:31</td>
      <td>u</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>T</td>
      <td>NaN</td>
      <td>LP-DIR-AF:DE-BFL:DA-DIR</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>g</td>
      <td>NED1-2</td>
      <td>pmagpy-4.2.25: demag_gui</td>
      <td>NED1-2b</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED1-2b</th>
      <td>This study</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>mc</td>
      <td>3.4</td>
      <td>149.9</td>
      <td>76.3</td>
      <td>0.4</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>NED1-2b_LP-DIR-AF</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>hargrave 2018-09-21 19:30:31</td>
      <td>u</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>T</td>
      <td>NaN</td>
      <td>LP-DIR-AF:DE-BFL:DA-DIR-GEO</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>g</td>
      <td>NED1-2</td>
      <td>pmagpy-4.2.25: demag_gui</td>
      <td>NED1-2b</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>NED18-2c</th>
      <td>This study</td>
      <td>105.900000</td>
      <td>Verwey</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>IRM-BigRed</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>SM-1DMAX:LP-FC</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NED18-2</td>
      <td>None</td>
      <td>NED18-2c</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED18-2c</th>
      <td>This study</td>
      <td>106.300000</td>
      <td>Verwey</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>IRM-BigRed</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>SM-1DMAX:LP-FC</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NED18-2</td>
      <td>None</td>
      <td>NED18-2c</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NED18-2c</th>
      <td>None</td>
      <td>105.861068</td>
      <td>Verwey</td>
      <td>calculated using MPMS_verwey_fit.ipynb with pa...</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>SM-1DMAX:LP-FC</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NED18-2</td>
      <td>None</td>
      <td>NED18-2c</td>
      <td>NaN</td>
      <td>0.000254</td>
    </tr>
    <tr>
      <th>NED2-8c</th>
      <td>None</td>
      <td>116.145701</td>
      <td>Verwey</td>
      <td>calculated using MPMS_verwey_fit.ipynb with pa...</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>SM-1DMAX:LP-FC</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NED2-8</td>
      <td>None</td>
      <td>NED2-8c</td>
      <td>NaN</td>
      <td>0.000188</td>
    </tr>
    <tr>
      <th>NED4-1c</th>
      <td>None</td>
      <td>117.902959</td>
      <td>Verwey</td>
      <td>calculated using MPMS_verwey_fit.ipynb with pa...</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NaN</td>
      <td>SM-1DMAX:LP-FC</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>NED4-1</td>
      <td>None</td>
      <td>NED4-1c</td>
      <td>NaN</td>
      <td>0.000211</td>
    </tr>
  </tbody>
</table>
<p>1577 rows × 38 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="k">def</span><span class="w"> </span><span class="nf">contribution_to_magic</span><span class="p">(</span><span class="n">contribution</span><span class="p">,</span> <span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Write a contribution object to MagIC-formatted files in the specified directory.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    contribution : Contribution</span>
<span class="sd">        A contribution object containing tables to be written to a MagIC-formatted file.</span>
<span class="sd">    dir_path : str</span>
<span class="sd">        The directory path where the MagIC-formatted file will be written.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dir_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
        
    <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;specimens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">write_magic_file</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">)</span>
    <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;samples&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">write_magic_file</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">)</span>
    <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;sites&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">write_magic_file</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">)</span>
    <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;locations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">write_magic_file</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">)</span>
    <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;measurements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">write_magic_file</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">)</span>
    
    <span class="n">ipmag</span><span class="o">.</span><span class="n">upload_magic</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">input_dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contribution_to_magic</span><span class="p">(</span><span class="n">contribution</span><span class="p">,</span> <span class="n">dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-I- overwriting /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/specimens.txt
-I- 18 records written to specimens file
-I- overwriting /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/samples.txt
-I- 5 records written to samples file
-I- overwriting /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/sites.txt
-I- 5 records written to sites file
-I- overwriting /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/locations.txt
-I- 10 records written to locations file
-I- overwriting /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/measurements.txt
-I- 5018 records written to measurements file
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/locations.txt file successfully read in
10  records written to file  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/locations.txt written to  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/samples.txt file successfully read in
5  records written to file  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/samples.txt written to  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/specimens.txt file successfully read in
18  records written to file  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/specimens.txt written to  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/sites.txt file successfully read in
5  records written to file  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/sites.txt written to  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/measurements.txt file successfully read in
-I- dropping these columns: external_database_ids from the /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/measurements.txt table
5018  records written to file  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
-I- /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/measurements.txt written to  /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/upload.txt
Finished preparing upload file: /Users/unimos/0000_Github/RockmagPy-notebooks/example_data/ECMB/ECMB_31.Jul.2024.txt 
Validating upload file with public endpoint
status_code= 500
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MPMS_plot_ac.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Plot MPMS data (AC susceptibility)</p>
      </div>
    </a>
    <a class="right-next"
       href="MPMS_goethite_fit.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fit and remove the goethite component</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-scientific-python-libraries">Import scientific python libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-data">Import data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background-on-the-verwey-transition">Background on the Verwey transition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-verwey-transition-temperature">Estimating the Verwey transition temperature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactively-fit-the-verwey-transition">Interactively fit the Verwey transition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-rmag-verwey-estimate-function">Use the <code class="docutils literal notranslate"><span class="pre">rmag.verwey_estimate</span></code> function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-second-derivative-curve">Plot the second derivative curve</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-and-record-the-verwey-temperatures-for-multiple-specimens">Determine and record the Verwey temperatures for multiple specimens</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-these-verwey-estimates-to-the-specimens-magic-table">Add these Verwey estimates to the specimens MagIC table</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By RockmagPy Contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>