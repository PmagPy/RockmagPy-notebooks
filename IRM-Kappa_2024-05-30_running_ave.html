
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Analysis of susceptibility-temperature, k(T), data &#8212; RockmagPy Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'IRM-Kappa_2024-05-30_running_ave';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="book/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/rockmagpy.png" class="logo__image only-light" alt="RockmagPy Documentation - Home"/>
    <script>document.write(`<img src="_static/rockmagpy.png" class="logo__image only-dark" alt="RockmagPy Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="book/intro.html">
                    RockmagPy: tools for rock magnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Nuts &amp; Bolts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rockmag_set_up.html">Getting going with rockmag.py on JupyterHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="rockmag_data_unpack.html">Rock magnetic experiments data import</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MPMS notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot_dc.html">Plot MPMS data (DC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot_ac.html">Plot MPMS data (AC susceptibility)</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_verwey_fit.html">Estimate the Verwey transition temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_goethite_fit.html">Fit and remove the goethite component</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermomagnetic notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="high_T_susceptibility.html">Plot high temperature susceptibility data (Kappabridge <span class="math notranslate nohighlight">\(\chi\)</span>-T)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Anisotropy notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Anisotropy_plot_AMS.html">Plot and analyze anisotropy data (AMS)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">More resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/resources.html">Resources for learning more about rock magnetism</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks/issues/new?title=Issue%20on%20page%20%2FIRM-Kappa_2024-05-30_running_ave.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/IRM-Kappa_2024-05-30_running_ave.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analysis of susceptibility-temperature, <span style="font-family: 'Times New Roman';">k(T)</span>, data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-packages">1. Install and import packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-the-data-from-a-magic-contribution">2. Import the data from a MagIC contribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-a-k-t-specimen">3. Select a <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> Specimen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#call-the-measurement-data-for-the-selected-specimen">4. Call the measurement data for the selected specimen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-heating-and-cooling-k-t-curves">5. Plot the heating and cooling <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> curves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-average-smoothing">6. Running Average Smoothing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-first-and-second-derivatives-of-the-k-t-data">7. Plot the first and second derivatives of the <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-tc-using-inverse-susceptibility">8. Calculate <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> using inverse susceptibility</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analysis-of-susceptibility-temperature-k-t-data">
<h1>Analysis of susceptibility-temperature, <span style="font-family: 'Times New Roman';"><em>k(T)</em></span>, data<a class="headerlink" href="#analysis-of-susceptibility-temperature-k-t-data" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<p>This notebook allows the user to:</p>
<p>(1) Download a contribution from the MagIC database.</p>
<p>(2) Extract any susceptibility-temperature, <span style="font-family: 'Times New Roman';"><em>k(T)</em></span>, data contained within it.</p>
<p>(3) Correct for the diamagnetic signal of the measurement instrument and holder (if required).</p>
<p>(4) Smooth the data prior to further anaysis (if required).</p>
<p>(5) Calculate Curie Temperatures, <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span>, using first and second-order derivatives.</p>
<p>The notebook is to be run cell-by-cell to allow users to select corrections/filters as needed. The code below runs an example dataset from <a class="reference external" href="https://doi.org/10.1029/2021JB023789">Doctor and Feinberg (2022)</a>, D|ifferential thermal analysis using high temperature susceptibility instruments, <em>Journal of Geophysical Research: Solid Earth</em>, which is MagiC contribution <a class="reference external" href="http://dx.doi.org/10.7288/V4/MAGIC/19369">19369</a>. Any MagIC contribution which contains <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> data can be used in place of this example dataset.</p>
<p><strong>Nota bene:</strong> We do not provide Curie Temperature estimation by the “two-tangent” method, as proposed for spontaneous magnetization  <span style="font-family: 'Times New Roman';"><em>M<sub>s</sub>(T)</em></span> curves by <a class="reference external" href="https://doi.org/10.1029/JB074i022p05277">Grommé et al. (1969)</a>. <a class="reference external" href="https://doi.org/10.1029/2012GC004440">Fabian et al. (2013)</a> explain this well:</p>
<p><em>“The importance of the difference between determining <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> from <span style="font-family: 'Times New Roman';">M<sub>s</sub>(T)</span> and <span style="font-family: 'Times New Roman';">k(T)</span> is pointed out by <a class="reference external" href="https://doi.org/10.1029/2006JB004507">Petrovský and Kapicka (2006)</a>, where methods to determine <span style="font-family: 'Times New Roman';">T<sub>c</sub></span> from measurements of the initial susceptibility are analyzed. They conclude that the two-tangent method is not suitable for <span style="font-family: 'Times New Roman';">k(T)</span> and can considerably overestimate <span style="font-family: 'Times New Roman';">T<sub>c</sub></span>. The physical origin of  <span style="font-family: 'Times New Roman';">k(T)</span> close to <span style="font-family: 'Times New Roman';">T<sub>c</sub></span> is more challenging than that of <span style="font-family: 'Times New Roman';">M<sub>s</sub>(T)</span>, because a number of low-field effects are important for <span style="font-family: 'Times New Roman';">k(T)</span>, but become negligible in the higher fields used to infer <span style="font-family: 'Times New Roman';">M<sub>s</sub>(T)</span>. The variation of <span style="font-family: 'Times New Roman';">m</span> depends not only on the variation of <span style="font-family: 'Times New Roman';">M<sub>s</sub>(H,T)</span> with field  <span style="font-family: 'Times New Roman';">H</span>, it also contains a contribution from a rotation of the ordered moment with respect to an easy magnetization axis, and contributions from thermally activated switching of small independent – but already magnetically ordered – regions (e.g., SP particles). In large bulk material domain-wall movement contributes to <span style="font-family: 'Times New Roman';">k(T)</span> even slightly below  <span style="font-family: 'Times New Roman';">Tc</span>. In nanoparticles the inhomogeneity of <span style="font-family: 'Times New Roman';">M<sub>s</sub></span>, due to the different exchangecoupling of inner and surface atoms, is of additional importance.”</em></p>
<p>And from <a class="reference external" href="https://doi.org/10.1029/2006JB004507">Petrovský and Kapicka (2006)</a>:</p>
<p><em>“…susceptibility for T [to] <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> and T &lt; <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> increases to infinity, and we have to use analytical formulas developed for susceptibility behavior above the Curie point. Here, due to the geometry of the susceptibility curve, the two-tangent method will always yield temperature above the inflection point, which is higher than the temperature at which the substance starts to obey the paramagnetic Curie-Weiss law. The resulting error in <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> (or <span style="font-family: 'Times New Roman';">T<sub>N</sub><sup>1</sup></span>) can be on the order of several degrees to several tens of degrees. Therefore, in the case of temperature dependence of magnetic susceptibility, application of the two-tangent method is not justified.”</em></p>
<p>Furthermore:</p>
<p><em>“In the case of synthetic magnetite and hematite, with sharp Hopkinson peak, the difference between transition
temperatures determined using the two-tangent method and Curie-Weiss paramagnetic law is in the order of some few
degrees. In the case of samples with wide susceptibility maximum and gradual decrease, reflecting e.g., wide distribution
of grain sizes, or in the case of substituted hematite, application of the two-tangent method to susceptibility curves overestimates the transition temperature be several tens of degrees.”</em></p>
<p><sup>1</sup>Néel Temperature</p>
<p>Key components here include portions of notebooks, and functions developed for the EarthRef JupyterHub:
<a class="reference external" href="https://www2.earthref.org/MagIC/jupyter-notebooks">https://www2.earthref.org/MagIC/jupyter-notebooks</a></p>
<section id="install-and-import-packages">
<h2>1. Install and import packages<a class="headerlink" href="#install-and-import-packages" title="Link to this heading">#</a></h2>
<p>Click inside the cell below, hold shift and then press enter. This will automatically run the script below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import all packages needed for plotting and calculations</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--user<span class="w"> </span>plotly
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>statsmodels
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>jupyter_core

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pmagpy.ipmag</span> <span class="k">as</span> <span class="nn">ipmag</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">pyo</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">clear_output</span><span class="p">,</span> <span class="n">Javascript</span> 
<span class="kn">from</span> <span class="nn">notebook</span> <span class="kn">import</span> <span class="n">notebookapp</span>
<span class="kn">from</span> <span class="nn">statsmodels.nonparametric.smoothers_lowess</span> <span class="kn">import</span> <span class="n">lowess</span>

<span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="s1">&#39;IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: plotly in c:\users\boss\anaconda3\lib\site-packages (5.9.0)
Requirement already satisfied: tenacity&gt;=6.2.0 in c:\users\boss\anaconda3\lib\site-packages (from plotly) (8.0.1)
Requirement already satisfied: statsmodels in c:\users\boss\anaconda3\lib\site-packages (0.13.2)
Requirement already satisfied: numpy&gt;=1.17 in c:\users\boss\anaconda3\lib\site-packages (from statsmodels) (1.21.5)
Requirement already satisfied: scipy&gt;=1.3 in c:\users\boss\anaconda3\lib\site-packages (from statsmodels) (1.9.1)
Requirement already satisfied: pandas&gt;=0.25 in c:\users\boss\anaconda3\lib\site-packages (from statsmodels) (1.4.4)
Requirement already satisfied: patsy&gt;=0.5.2 in c:\users\boss\anaconda3\lib\site-packages (from statsmodels) (0.5.2)
Requirement already satisfied: packaging&gt;=21.3 in c:\users\boss\anaconda3\lib\site-packages (from statsmodels) (21.3)
Requirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in c:\users\boss\anaconda3\lib\site-packages (from packaging&gt;=21.3-&gt;statsmodels) (3.0.9)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\boss\anaconda3\lib\site-packages (from pandas&gt;=0.25-&gt;statsmodels) (2022.1)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in c:\users\boss\anaconda3\lib\site-packages (from pandas&gt;=0.25-&gt;statsmodels) (2.8.2)
Requirement already satisfied: six in c:\users\boss\anaconda3\lib\site-packages (from patsy&gt;=0.5.2-&gt;statsmodels) (1.16.0)
Requirement already satisfied: jupyter_core in c:\users\boss\anaconda3\lib\site-packages (4.11.1)
Requirement already satisfied: pywin32&gt;=1.0 in c:\users\boss\anaconda3\lib\site-packages (from jupyter_core) (302)
Requirement already satisfied: traitlets in c:\users\boss\anaconda3\lib\site-packages (from jupyter_core) (5.1.1)
</pre></div>
</div>
<script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())</script></div>
</div>
</section>
<section id="import-the-data-from-a-magic-contribution">
<h2>2. Import the data from a MagIC contribution<a class="headerlink" href="#import-the-data-from-a-magic-contribution" title="Link to this heading">#</a></h2>
<p>(1)    Run the following cell by pressing “Import”. This will generate a box for you to type in the MagIC Contribution        ID of interest.</p>
<p>(2)    The default is for the dataset of <em>Doctor and Feinberg (2022)</em>. MagIC ID = <strong>19369</strong>. But you will want to find the MagIC ID of the study you are interested in and add this in the box below.</p>
<p>(3)    Click on ‘Download MagIC File’. This will:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  (a) create a subdirectory to the directory this notebook is saved in and will be given the name of the MagIC ID,     
  e.g., 19369; 

  (b) download the MagIC contribution file, e.g., magic_contribution_19369.txt, to the subdirectory; 

  (c) &quot;unpack&quot; this file to a series of txt files called locations, sites, samples, specimens and measurements.  
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">import_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Import&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">import_file</span><span class="p">(</span><span class="n">button_click</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="s1">&#39;IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())&#39;</span><span class="p">))</span>
<span class="n">import_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">import_file</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">import_button</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "970f8052768b413ab96cb936a153c4eb", "version_major": 2, "version_minor": 0}</script><script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())</script><script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get current notebook path</span>
<span class="n">current_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="c1"># Define the default value for magic_id</span>
<span class="n">magic_id</span> <span class="o">=</span> <span class="s1">&#39;19369&#39;</span>
<span class="n">magic_file_name</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Initialize magic_file_name as None</span>

<span class="c1"># Create a text box widget with the default value</span>
<span class="n">magic_id_textbox</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">magic_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;MagIC Contribution ID:&#39;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">})</span>

<span class="c1"># Function to handle changes in the text box value</span>
<span class="k">def</span> <span class="nf">update_magic_id</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">magic_id</span>
    <span class="n">magic_id</span> <span class="o">=</span> <span class="n">change</span><span class="o">.</span><span class="n">new</span>

<span class="c1"># Attach the event handler to the text box</span>
<span class="n">magic_id_textbox</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_magic_id</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Display the text box</span>
<span class="n">display</span><span class="p">(</span><span class="n">magic_id_textbox</span><span class="p">)</span>

<span class="c1"># Add a button to trigger the download</span>
<span class="n">download_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Download Magic File&quot;</span><span class="p">)</span>

<span class="c1"># Function to handle the button click event and trigger the download</span>
<span class="k">def</span> <span class="nf">download_magic_file</span><span class="p">(</span><span class="n">button_click</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">magic_file_name</span>  <span class="c1"># Declare magic_file_name as global</span>
    <span class="k">global</span> <span class="n">save_path</span>
    <span class="k">global</span> <span class="n">dpath</span>
    
    <span class="c1">#Creates a subdirectory with the name of the magic_id</span>
    <span class="n">subdirectory_name</span> <span class="o">=</span> <span class="n">magic_id</span>
    <span class="n">dpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_path</span><span class="p">,</span> <span class="n">subdirectory_name</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subdirectory created at: </span><span class="si">{</span><span class="n">dpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1">#Downloads the file from MagIC and saves it automatically in the subdirectory</span>
    <span class="n">magic_dlink</span> <span class="o">=</span> <span class="s2">&quot;https://earthref.org/MagIC/download/&quot;</span> <span class="o">+</span> <span class="n">magic_id</span> <span class="o">+</span> <span class="s2">&quot;/magic_contribution_&quot;</span> <span class="o">+</span> <span class="n">magic_id</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>
<span class="c1">#    print(magic_dlink)</span>
<span class="c1">#    magic_dlink = &quot;https://earthref.org/MagIC/download/19369/magic_contribution_19369.txt&quot;</span>
    <span class="n">save_name</span> <span class="o">=</span> <span class="s2">&quot;magic_contribution_&quot;</span> <span class="o">+</span> <span class="n">magic_id</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>
<span class="c1">#    print(save_name)</span>
    <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span> <span class="n">save_name</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">magic_dlink</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File downloaded and saved to: </span><span class="si">{</span><span class="n">save_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="s1">&#39;IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+2, IPython.notebook.ncells())&#39;</span><span class="p">))</span>
                
<span class="c1">#   unpack the file into locations, sites, samples, specimens, etc </span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">unpack_magic</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span> 
                      <span class="n">dpath</span><span class="p">,</span>
                      <span class="n">dpath</span><span class="p">)</span>
    
<span class="c1"># Attach the event handler to the download button</span>
<span class="n">download_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">download_magic_file</span><span class="p">)</span>

<span class="c1"># Display the download button</span>
<span class="n">display</span><span class="p">(</span><span class="n">download_button</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "583e4a7304504afd8de6c885f00cd80c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "df63cffb340a4f1dbe19a4069a2495f7", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Subdirectory created at: C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769
File downloaded and saved to: C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\magic_contribution_16769.txt
</pre></div>
</div>
<script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+2, IPython.notebook.ncells())</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>working on:  &#39;contribution&#39;
1  records written to file  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\contribution.txt
contribution  data put in  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\contribution.txt
working on:  &#39;locations&#39;
1  records written to file  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\locations.txt
locations  data put in  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\locations.txt
working on:  &#39;sites&#39;
53  records written to file  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\sites.txt
sites  data put in  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\sites.txt
working on:  &#39;samples&#39;
53  records written to file  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\samples.txt
samples  data put in  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\samples.txt
working on:  &#39;specimens&#39;
207  records written to file  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\specimens.txt
specimens  data put in  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\specimens.txt
working on:  &#39;measurements&#39;
340827  records written to file  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\measurements.txt
measurements  data put in  C:\Users\boss\Documents\GitHub\RockmagPy-notebooks\16769\measurements.txt
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-a-k-t-specimen">
<h2>3. Select a <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> Specimen<a class="headerlink" href="#select-a-k-t-specimen" title="Link to this heading">#</a></h2>
<p><em>Creates a dropdown to select specimens with <span style="font-family: 'Times New Roman';">k(T)</span> data.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimens</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">spfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s1">&#39;specimens.txt&#39;</span><span class="p">)</span>
<span class="n">specimens</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">spfile</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">dfs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">specimens</span><span class="p">)</span>

<span class="c1"># Filter DataFrame where method_code equals &#39;LP-X-T&#39;</span>
<span class="n">filtered_dfs</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LP-X-T&#39;</span><span class="p">)]</span>

<span class="c1"># Extract unique values from specimen column</span>
<span class="n">specimen_names</span> <span class="o">=</span> <span class="n">filtered_dfs</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Create a dropdown widget with these unique values</span>
<span class="n">dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">specimen_names</span><span class="p">,</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Specimen:&#39;</span><span class="p">,</span>
    <span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Define a variable to store the selected value</span>
<span class="n">selected_specimen</span> <span class="o">=</span> <span class="n">specimen_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Initialize with the first value</span>

<span class="c1"># Define a callback function to update the variable</span>
<span class="k">def</span> <span class="nf">on_change</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">selected_specimen</span>
    <span class="n">selected_specimen</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected value updated to: </span><span class="si">{</span><span class="n">selected_specimen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="s1">&#39;IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+2, IPython.notebook.ncells())&#39;</span><span class="p">))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="s1">&#39;IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+4, IPython.notebook.ncells())&#39;</span><span class="p">))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="s1">&#39;IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+5, IPython.notebook.ncells())&#39;</span><span class="p">))</span>
    
<span class="c1"># Link the callback function to the dropdown widget</span>
<span class="n">dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_change</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Display the dropdown widget</span>
<span class="n">display</span><span class="p">(</span><span class="n">dropdown</span><span class="p">)</span>

<span class="c1"># Example usage of the selected_value variable in other code</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initially selected value: </span><span class="si">{</span><span class="n">selected_specimen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "902eb475d34c4aabae079b3a4e5ad1d1", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initially selected value: 360-U1473A-03R-3-W-116-r4
Selected value updated to: 360-U1473A-84R-1-W-143-r4
</pre></div>
</div>
<script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+2, IPython.notebook.ncells())</script><script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+4, IPython.notebook.ncells())</script><script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+5, IPython.notebook.ncells())</script></div>
</div>
</section>
<section id="call-the-measurement-data-for-the-selected-specimen">
<h2>4. Call the measurement data for the selected specimen<a class="headerlink" href="#call-the-measurement-data-for-the-selected-specimen" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter by method code and specimen type</span>
<span class="c1"># Split data up into heating and cooling curves</span>

<span class="n">filtered_dfm</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">dfm</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">mfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dpath</span><span class="p">,</span><span class="s1">&#39;measurements.txt&#39;</span><span class="p">)</span>

<span class="c1"># Read the data from the &quot;measurements.txt&quot; file into a DataFrame</span>
<span class="n">dfm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">mfile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Filter for k(T) data and the selected specimen name</span>
<span class="n">filtered_dfm</span> <span class="o">=</span> <span class="n">dfm</span><span class="p">[(</span><span class="n">dfm</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LP-X-T&#39;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfm</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">selected_specimen</span><span class="p">)]</span>

<span class="c1">#Correct automatically for negative susceptibility values - will throw off derivatives and inverse susc calculations</span>
<span class="n">filtered_dfm</span><span class="p">[</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">filtered_dfm</span><span class="p">[</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_dfm</span><span class="p">[</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">filtered_dfm</span><span class="p">[</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">*-</span><span class="mi">1</span>

<span class="k">if</span> <span class="s1">&#39;meas_temp&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filtered_dfm</span><span class="p">:</span>
    <span class="n">filtered_dfm</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;treat_temp&#39;</span><span class="p">:</span> <span class="s1">&#39;meas_temp&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Convert temperatures to degrees centigrade</span>
<span class="c1"># Add a catch as some people forget to enter the temperatures in Kelvin...</span>

<span class="k">if</span> <span class="n">filtered_dfm</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">273.15</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">filtered_dfm</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">273.15</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">filtered_dfm</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span>

<span class="c1"># Select only temperature in Kelvin and mass normalized susceptibilty (m3/kg)</span>
<span class="n">kT_all</span> <span class="o">=</span> <span class="n">filtered_dfm</span><span class="p">[[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Max temperature</span>
<span class="n">max_T</span> <span class="o">=</span> <span class="n">kT_all</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># Row of max temperature</span>
<span class="n">max_T_step</span> <span class="o">=</span> <span class="n">kT_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kT_all</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_T</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Split data into heating and cooling curves, i.e. heating is less than max_T_step and cooling is greater than max_T_step</span>
<span class="n">heat</span> <span class="o">=</span> <span class="n">kT_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kT_all</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">max_T_step</span><span class="p">]</span>
<span class="n">cool</span> <span class="o">=</span> <span class="n">kT_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">kT_all</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">max_T_step</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-heating-and-cooling-k-t-curves">
<h2>5. Plot the heating and cooling <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> curves<a class="headerlink" href="#plot-the-heating-and-cooling-k-t-curves" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a plot for the &#39;heat&#39; dataset with red points and a line</span>
<span class="n">fig_heat</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Add heat data as a scatter plot with red points and lines</span>
<span class="n">fig_heat</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">heat</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">heat</span><span class="p">[</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Heating - zero corrected&#39;</span>
<span class="p">))</span>

<span class="c1"># Create a scatter plot for the &#39;cooling&#39; dataset with blue points and a line</span>
<span class="n">fig_cool</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Add cooling data as a scatter plot with blue points and lines</span>
<span class="n">fig_cool</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">cool</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">cool</span><span class="p">[</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cooling - zero corrected&#39;</span>
<span class="p">))</span>

<span class="c1"># Combine the two figures</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fig_heat</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">fig_cool</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">900</span>  <span class="c1"># Adjust the width to your preference</span>
<span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mf">1.618</span><span class="p">)</span>  <span class="c1"># Calculate height based on the golden ratio</span>

<span class="c1"># Update the layout with a unified title and labels</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_specimen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Center the title</span>
        <span class="s1">&#39;xanchor&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span>
    <span class="p">},</span>
    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Temperature (&amp;deg;C)&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;&lt;i&gt;k&lt;/i&gt; (m&lt;sup&gt;3&lt;/sup&gt; kg&lt;sup&gt;-1&lt;/sup&gt;)&#39;</span><span class="p">,</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>  <span class="c1"># Background color of the entire plot</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>   <span class="c1"># Background color of the plotting area</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Roboto, sans-serif&#39;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Black&quot;</span>
    <span class="p">),</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Start at 0</span>
        <span class="n">dtick</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># Tick every 100 units</span>
        <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>  <span class="c1"># Color of the grid lines</span>
        <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the grid lines</span>
        <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show x-axis line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the x-axis line</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>  <span class="c1"># Color of the x-axis line</span>
    <span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="c1"># Automatic tick marks on the y-axis</span>
        <span class="n">autorange</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Reversed for easier reading</span>
        <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.1e&#39;</span><span class="p">,</span>  <span class="c1"># Scientific notation format</span>
        <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>  <span class="c1"># Color of the grid lines</span>
        <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the grid lines</span>
        <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show y-axis line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the y-axis line</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>  <span class="c1"># Color of the y-axis line</span>
    <span class="p">),</span>
        <span class="n">shapes</span><span class="o">=</span><span class="p">[</span>
        <span class="c1"># Frame around the plot</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span><span class="p">,</span>
            <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span>
            <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust left margin</span>
        <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust right margin</span>
        <span class="n">b</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust bottom margin</span>
        <span class="n">t</span><span class="o">=</span><span class="mi">80</span>   <span class="c1"># Adjust top margin for title</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Show the combined plot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="c87f20d5-7e8b-4f52-95c9-b146ac382cc3" class="plotly-graph-div" style="height:556px; width:900px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c87f20d5-7e8b-4f52-95c9-b146ac382cc3")) {                    Plotly.newPlot(                        "c87f20d5-7e8b-4f52-95c9-b146ac382cc3",                        [{"line":{"color":"red"},"marker":{"color":"red"},"mode":"lines+markers","name":"Heating - zero corrected","x":[25.55000000000001,26.55000000000001,31.75,38.75,46.75,54.55000000000001,61.85000000000002,68.85000000000002,75.45000000000005,81.45000000000005,86.45000000000005,92.75,96.15000000000003,101.95000000000005,107.25,112.55000000000001,116.55000000000001,121.05000000000001,125.25,130.35000000000002,134.55,139.15000000000003,143.95000000000005,148.75,153.05,157.55,162.65000000000003,166.95000000000005,171.55,176.15000000000003,181.05,186.45000000000005,191.05,196.25,200.05,205.15000000000003,209.55,214.45000000000005,219.35000000000002,223.75,228.75,234.25,238.85000000000002,243.85000000000002,248.55000000000007,253.75,258.55000000000007,263.45000000000005,268.25,272.65,277.65,282.45000000000005,287.75,292.25,297.25,302.35,306.85,311.95000000000005,316.45000000000005,322.05000000000007,326.65,331.75,335.65,339.95000000000005,345.35,349.35,354.25,359.35,363.65,368.85,373.15,378.05000000000007,382.05000000000007,387.55000000000007,391.35,396.25,400.05000000000007,404.35,409.95000000000005,414.05000000000007,418.05000000000007,422.45000000000005,427.45000000000005,431.85,436.55000000000007,440.35,445.05000000000007,448.95000000000005,453.65,458.05000000000007,461.65,466.45000000000005,469.95000000000005,475.05000000000007,478.95000000000005,482.45000000000005,486.65,491.15,495.35,499.25,503.15,507.65,512.25,516.15,520.35,524.35,528.25,532.5500000000001,536.45,540.15,544.0500000000001,548.0500000000001,552.65,556.35,560.35,564.65,569.5500000000001,572.25,576.65,581.5500000000001,584.95,588.95,593.65,596.15,600.45,604.25,608.95,612.95,616.15,620.15,623.65,628.35,632.15,635.95,639.35,643.85,647.65,651.0500000000001,655.25,658.75,663.15,667.0500000000001,670.85,674.0500000000001,678.85,681.75,686.85,688.45,692.35,696.85,701.0500000000001,702.95],"y":[0.42341029999999996,0.4272703,0.42724029999999996,0.4269403,0.4224503,0.42158029999999996,0.4167803,0.41193029999999997,0.41093029999999997,0.4100003,0.4092303,0.4082703,0.40776029999999996,0.4069203,0.4061903,0.40549029999999997,0.40499029999999997,0.4044603,0.4001503,0.40732029999999997,0.3992403,0.3988403,0.40232029999999996,0.40199029999999997,0.4017303,0.3976503,0.4012803,0.4011303,0.4010003,0.4047503,0.4008303,0.4008003,0.4046403,0.4046703,0.4047203,0.4048003,0.4048903,0.40116029999999997,0.4051403,0.4091203,0.4092803,0.40948029999999996,0.40965029999999997,0.4098403,0.4100203,0.4102303,0.41042029999999996,0.4106103,0.41464029999999996,0.4148003,0.4111403,0.41515029999999997,0.4153203,0.4154703,0.4156103,0.4196003,0.4197203,0.4159903,0.4199403,0.4200503,0.4162803,0.41637029999999997,0.4202703,0.41264029999999996,0.4127103,0.41276029999999997,0.4166603,0.41287029999999997,0.41292029999999996,0.4091403,0.41304029999999997,0.4092703,0.4131803,0.4171203,0.41720029999999997,0.41731029999999997,0.4212603,0.4175403,0.42158029999999996,0.4255903,0.4257603,0.4259803,0.42625029999999997,0.4303703,0.4345403,0.4348303,0.4352203,0.4394203,0.4398903,0.4442103,0.4446303,0.4452403,0.44956029999999997,0.4503003,0.4547503,0.4591803,0.4599103,0.4607503,0.4654203,0.4623903,0.4632403,0.4642803,0.4653903,0.46254029999999996,0.4598103,0.45322029999999996,0.4466503,0.43640029999999996,0.4222303,0.41187029999999997,0.3939303,0.3683703,0.3315303,0.2790203,0.21128029999999998,0.1321503,0.060984300000000005,0.0351393,0.0176953,0.0158803,0.013468300000000002,0.0113323,0.009523299999999998,0.0106183,0.008670299999999999,0.0103613,0.0124663,0.0104193,0.008014299999999999,0.0098163,0.011389300000000002,0.013492300000000002,0.011333300000000001,0.009159299999999999,0.0106393,0.012568300000000001,0.0103193,0.0117213,0.0095663,0.010935299999999998,0.008752300000000001,0.0063221,0.0076423,0.008704300000000002,0.0063591,0.0072083,0.008586300000000002,0.0012941000000000003,0.0022013,0.0031205,0.0,0.0041302],"type":"scatter"},{"line":{"color":"blue"},"marker":{"color":"blue"},"mode":"lines+markers","name":"Cooling - zero corrected","x":[702.65,700.75,698.75,695.85,693.25,691.0500000000001,687.85,684.25,681.45,678.15,675.95,672.15,669.25,665.45,662.25,658.45,655.25,652.35,648.85,645.35,642.25,638.75,635.25,631.85,628.35,624.85,621.45,616.75,614.25,610.75,606.15,602.65,598.95,593.95,590.85,587.45,583.75,580.35,576.65,572.95,568.65,565.25,561.25,556.95,553.5500000000001,549.25,545.65,541.35,537.95,534.0500000000001,529.75,525.85,521.5500000000001,517.95,513.75,509.75,504.65,501.05000000000007,497.15,492.65,488.15,484.25,479.85,475.65,471.75,466.75,462.55000000000007,458.35,454.55000000000007,449.85,445.35,441.25,436.85,432.45000000000005,429.25,423.65,420.15,414.55000000000007,410.55000000000007,405.85,401.15,396.85,392.75,388.45000000000005,383.85,379.15,374.85,369.65,366.25,360.55000000000007,356.25,351.65,347.35,342.55000000000007,338.25,334.55000000000007,329.75,324.35,320.35,315.05000000000007,310.75,305.95000000000005,301.45000000000005,296.75,292.25,287.75,283.55000000000007,278.55000000000007,273.75,269.85,265.15,260.15,255.14999999999998,250.75,246.05000000000007,241.64999999999998,236.95000000000005,232.25,227.85000000000002,223.45000000000005,219.15000000000003,214.45000000000005,210.05,205.75,201.15000000000003,196.25,191.85000000000002,187.25,182.95000000000005,178.05,173.75,169.65000000000003,165.15000000000003,161.05,156.55,152.25,147.95000000000005,143.95000000000005,139.15000000000003,135.15000000000003,130.35000000000002,126.55000000000001,122.35000000000002,118.35000000000002,114.15000000000003,110.45000000000005,106.75,103.85000000000002,98.55000000000001,94.85000000000002,91.45000000000005,87.45000000000005,84.05000000000001,80.35000000000002,76.25,73.05000000000001,69.95000000000005,67.05000000000001,63.650000000000034,61.05000000000001,57.450000000000045,55.05000000000001,52.75,49.85000000000002,47.55000000000001,45.150000000000034,42.85000000000002,40.75,38.950000000000045],"y":[0.0079333,0.0037987999999999997,0.0034650999999999996,0.006774700000000001,0.006242500000000001,0.009602300000000001,0.012684300000000003,0.0117483,0.014814300000000002,0.013839300000000002,0.013158300000000001,0.0119253,0.014786300000000002,0.017287300000000002,0.012264299999999999,0.0146653,0.0172583,0.0160963,0.0185103,0.0132023,0.0157323,0.0142253,0.0126993,0.018893300000000002,0.013492300000000002,0.0157733,0.014247300000000001,0.019823300000000002,0.0148503,0.017121300000000002,0.0150573,0.0134943,0.015698300000000002,0.0135003,0.0159983,0.018380300000000002,0.012960300000000001,0.015379300000000002,0.0176953,0.023882300000000002,0.0337063,0.0746853,0.13854029999999998,0.21386029999999998,0.2895403,0.3534003,0.39832029999999996,0.42380029999999996,0.4380903,0.4484003,0.45094029999999996,0.4536503,0.4562903,0.4591703,0.4580803,0.4570903,0.45589029999999997,0.4589303,0.45810029999999996,0.4610403,0.4601903,0.4556403,0.4587503,0.4542403,0.4498103,0.4529703,0.45244029999999996,0.45194029999999996,0.4476803,0.4472003,0.4467903,0.4464403,0.4461003,0.4458003,0.4417503,0.4414203,0.4450903,0.4409903,0.4408303,0.44067029999999996,0.4366703,0.4327103,0.4326103,0.43252029999999997,0.4362803,0.4285103,0.43230029999999997,0.4283803,0.4283403,0.4244303,0.4282203,0.4243203,0.4242703,0.4242103,0.4241603,0.4241003,0.42403029999999997,0.42009029999999997,0.42386029999999997,0.4199103,0.41981029999999997,0.41969029999999996,0.41958029999999996,0.4194503,0.4154703,0.4191703,0.4151903,0.4150103,0.4148403,0.41470029999999997,0.4106703,0.4143203,0.4141303,0.4101103,0.40992029999999996,0.4097503,0.4095803,0.4055603,0.4092503,0.4091103,0.40898029999999996,0.4088503,0.4049003,0.4048103,0.4085803,0.4046703,0.40465029999999996,0.4046403,0.4008103,0.4047203,0.4009503,0.40104029999999996,0.4050303,0.4013403,0.40155029999999997,0.4056303,0.4058903,0.40232029999999996,0.4026903,0.4068803,0.40732029999999997,0.4115503,0.4120103,0.4086203,0.4091403,0.4096103,0.4139503,0.4105003,0.4151003,0.4156503,0.4161603,0.4206103,0.42114029999999997,0.4217103,0.4223403,0.4189903,0.4271503,0.42758029999999997,0.4280703,0.4322803,0.4327603,0.4330603,0.4333403,0.4336703,0.4377503,0.4341403,0.43818029999999997,0.4421903,0.43462029999999996],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"360-U1473A-84R-1-W-143-r4","x":0.5,"xanchor":"center"},"font":{"family":"Roboto, sans-serif","size":18,"color":"Black"},"xaxis":{"title":{"text":"Temperature (&deg;C)"},"tick0":0,"dtick":100,"gridcolor":"lightgray","gridwidth":1,"showline":true,"linewidth":1,"linecolor":"black"},"yaxis":{"title":{"text":"<i>k</i> (m<sup>3</sup> kg<sup>-1</sup>)"},"autorange":true,"tickformat":".1e","gridcolor":"lightgray","gridwidth":1,"showline":true,"linewidth":1,"linecolor":"black"},"margin":{"l":50,"r":50,"b":50,"t":80},"width":900,"height":556,"showlegend":true,"paper_bgcolor":"white","plot_bgcolor":"white","shapes":[{"line":{"color":"black","width":2},"type":"rect","x0":0,"x1":1,"xref":"paper","y0":0,"y1":1,"yref":"paper"}]},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('c87f20d5-7e8b-4f52-95c9-b146ac382cc3');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="running-average-smoothing">
<h2>6. Running Average Smoothing<a class="headerlink" href="#running-average-smoothing" title="Link to this heading">#</a></h2>
<p>Your data might be noisy, which may hinder interpretation of Curie Temperatures or assessing reversibility for understanding alteration. The following code will perform a running average of data over a temperature interval that you can define.</p>
<p>Two graphs will be created.</p>
<p>(1) The top graph shows the raw data as points and the smoothed data as lines, for the temperature window size selected.</p>
<p>(2) The bottom graphs compares the model roughness against the root mean square error of the model (note that the y-axis is inverted) (a measure of the difference between the running average and the data). Each point on the graph is for a different temperature window size. The knee in the curve (the break of slope) is the optimal tempeature window. At this point (window) there is a decent trade off between the smoothness of the model (the running average) and error on the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create temperature window box</span>
<span class="n">temp_window</span> <span class="o">=</span> <span class="s1">&#39;0.0&#39;</span>

<span class="c1"># Create a text box widget for the LOESS smoothing fraction</span>
<span class="n">temp_window_textbox</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">temp_window</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Temperature window size&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">})</span>

<span class="c1"># Add descriptive text next to the text box</span>
<span class="n">description_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\u00B0</span><span class="s1">C&#39;</span><span class="p">)</span>
<span class="n">description_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">temp_window_textbox</span><span class="p">,</span> <span class="n">description_label</span><span class="p">])</span>

<span class="c1"># Function to handle changes in the text box value</span>
<span class="k">def</span> <span class="nf">handle_textbox_change</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="n">new_value</span> <span class="o">=</span> <span class="n">change</span><span class="o">.</span><span class="n">new</span>
    <span class="k">if</span> <span class="n">new_value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">global</span> <span class="n">temp_window</span>
        <span class="n">temp_window</span> <span class="o">=</span> <span class="n">new_value</span>

<span class="c1"># Attach the event handler to monitor changes in the text box value</span>
<span class="n">temp_window_textbox</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">handle_textbox_change</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Function to execute code when button is clicked</span>
<span class="k">def</span> <span class="nf">execute_code</span><span class="p">(</span><span class="n">button</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="s1">&#39;IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())&#39;</span><span class="p">))</span>

<span class="c1"># Create a button widget for executing code</span>
<span class="n">execute_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Smooth&#39;</span><span class="p">)</span>

<span class="c1"># Attach the event handler to the button</span>
<span class="n">execute_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">execute_code</span><span class="p">)</span>

<span class="c1"># Display the text box, button, and descriptive text</span>
<span class="n">display</span><span class="p">(</span><span class="n">description_box</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">execute_button</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "502133b76fbb4462ba7f73116dd93c8c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "433c0c9741a94a99be513a63ee038875", "version_major": 2, "version_minor": 0}</script><script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())</script><script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())</script><script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())</script><script type="application/javascript">IPython.notebook.execute_cell_range(IPython.notebook.get_selected_index()+1, IPython.notebook.ncells())</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_window</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">temp_window</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">running_average</span><span class="p">(</span><span class="n">temp_list</span><span class="p">,</span> <span class="n">chi_list</span><span class="p">,</span> <span class="n">temp_window</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">temp_list</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">chi_list</span> <span class="ow">or</span> <span class="n">temp_window</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">temp_list</span><span class="p">,</span> <span class="n">chi_list</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[]</span>
    
    <span class="n">avg_temps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">avg_chis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">temp_vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">chi_vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="c1"># Determine the temperature range for the current point</span>
        <span class="n">temp_center</span> <span class="o">=</span> <span class="n">temp_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">start_temp</span> <span class="o">=</span> <span class="n">temp_center</span> <span class="o">-</span> <span class="n">temp_window</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">end_temp</span> <span class="o">=</span> <span class="n">temp_center</span> <span class="o">+</span> <span class="n">temp_window</span> <span class="o">/</span> <span class="mi">2</span>
        
        <span class="c1"># Get the indices within the temperature range</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">start_temp</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">end_temp</span><span class="p">]</span>
        
        <span class="c1"># Calculate the average temperature and susceptibility for the current window</span>
        <span class="k">if</span> <span class="n">indices</span><span class="p">:</span>
            <span class="n">temp_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">temp_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="n">chi_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">chi_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
            <span class="n">avg_temp</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">temp_range</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_range</span><span class="p">)</span>
            <span class="n">avg_chi</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">chi_range</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">chi_range</span><span class="p">)</span>
            <span class="n">temp_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">temp_range</span><span class="p">)</span>
            <span class="n">chi_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">chi_range</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">avg_temp</span> <span class="o">=</span> <span class="n">temp_center</span>
            <span class="n">avg_chi</span> <span class="o">=</span> <span class="n">chi_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">temp_var</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">chi_var</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="n">avg_temps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_temp</span><span class="p">)</span>
        <span class="n">avg_chis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_chi</span><span class="p">)</span>
        <span class="n">temp_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_var</span><span class="p">)</span>
        <span class="n">chi_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chi_var</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">avg_temps</span><span class="p">,</span> <span class="n">avg_chis</span><span class="p">,</span> <span class="n">temp_vars</span><span class="p">,</span> <span class="n">chi_vars</span>

<span class="c1"># From heating</span>
<span class="n">hT</span> <span class="o">=</span> <span class="n">heat</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">hk</span> <span class="o">=</span> <span class="n">heat</span><span class="p">[</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># From cooling</span>
<span class="n">cT</span> <span class="o">=</span> <span class="n">cool</span><span class="p">[</span><span class="s1">&#39;meas_temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">ck</span> <span class="o">=</span> <span class="n">cool</span><span class="p">[</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">avg_temp_heat</span><span class="p">,</span> <span class="n">avg_chi_heat</span><span class="p">,</span> <span class="n">temp_vars</span><span class="p">,</span> <span class="n">chi_vars</span> <span class="o">=</span> <span class="n">running_average</span><span class="p">(</span><span class="n">hT</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="n">temp_window</span><span class="p">)</span>
<span class="n">avg_temp_cool</span><span class="p">,</span> <span class="n">avg_chi_cool</span><span class="p">,</span> <span class="n">temp_vars</span><span class="p">,</span> <span class="n">chi_vars</span> <span class="o">=</span> <span class="n">running_average</span><span class="p">(</span><span class="n">cT</span><span class="p">,</span> <span class="n">ck</span><span class="p">,</span> <span class="n">temp_window</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">calculate_rms</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span> <span class="n">avg_chis</span><span class="p">):</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="p">[(</span><span class="n">chi</span> <span class="o">-</span> <span class="n">avg_chi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">chi</span><span class="p">,</span> <span class="n">avg_chi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span> <span class="n">avg_chis</span><span class="p">)]</span>
    <span class="n">rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rms</span>

<span class="k">def</span> <span class="nf">calculate_avg_variance_and_rms</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span> <span class="n">avg_chis</span><span class="p">,</span> <span class="n">temp_vars</span><span class="p">,</span> <span class="n">chi_vars</span><span class="p">):</span>
    <span class="n">rms_list</span> <span class="o">=</span> <span class="n">calculate_rms</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span> <span class="n">avg_chis</span><span class="p">)</span>
    <span class="n">total_rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rms_list</span><span class="p">)</span>
    <span class="n">avg_rms</span> <span class="o">=</span> <span class="n">total_rms</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">rms_list</span><span class="p">)</span>
    
    <span class="n">total_variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">chi_vars</span><span class="p">)</span>
    <span class="n">avg_variance</span> <span class="o">=</span> <span class="n">total_variance</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">chi_vars</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">avg_rms</span><span class="p">,</span> <span class="n">avg_variance</span>

<span class="k">def</span> <span class="nf">evaluate_window_sizes</span><span class="p">(</span><span class="n">temp_list</span><span class="p">,</span> <span class="n">chi_list</span><span class="p">,</span> <span class="n">window_sizes</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">window_size</span> <span class="ow">in</span> <span class="n">window_sizes</span><span class="p">:</span>
        <span class="n">avg_temps</span><span class="p">,</span> <span class="n">avg_chis</span><span class="p">,</span> <span class="n">temp_vars</span><span class="p">,</span> <span class="n">chi_vars</span> <span class="o">=</span> <span class="n">running_average</span><span class="p">(</span><span class="n">temp_list</span><span class="p">,</span> <span class="n">chi_list</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>
        <span class="n">avg_rms</span><span class="p">,</span> <span class="n">avg_variance</span> <span class="o">=</span> <span class="n">calculate_avg_variance_and_rms</span><span class="p">(</span><span class="n">chi_list</span><span class="p">,</span> <span class="n">avg_chis</span><span class="p">,</span> <span class="n">temp_vars</span><span class="p">,</span> <span class="n">chi_vars</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">window_size</span><span class="p">,</span> <span class="n">avg_rms</span><span class="p">,</span> <span class="n">avg_variance</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># Define the range of window sizes to evaluate</span>
<span class="n">window_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>

<span class="c1"># Evaluate for heating data</span>
<span class="n">results_heat</span> <span class="o">=</span> <span class="n">evaluate_window_sizes</span><span class="p">(</span><span class="n">hT</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="n">window_sizes</span><span class="p">)</span>

<span class="c1"># Evaluate for cooling data</span>
<span class="n">results_cool</span> <span class="o">=</span> <span class="n">evaluate_window_sizes</span><span class="p">(</span><span class="n">cT</span><span class="p">,</span> <span class="n">ck</span><span class="p">,</span> <span class="n">window_sizes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hT</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Heating Data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FFCCCC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cT</span><span class="p">,</span> <span class="n">ck</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Cooling Data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9FCAF0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">avg_temp_heat</span><span class="p">,</span> <span class="n">avg_chi_heat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Running Average Heating&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">avg_temp_cool</span><span class="p">,</span> <span class="n">avg_chi_cool</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Running Average Cooling&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (</span><span class="se">\u00B0</span><span class="s1">C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k (Am2/kg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">selected_specimen</span> <span class="o">+</span> <span class="s1">&#39;| Running Average Smoothing | Temperature Window = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">temp_window</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\u00B0</span><span class="s1">C&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_rms_vs_variance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">window_sizes</span><span class="p">,</span> <span class="n">rmses</span><span class="p">,</span> <span class="n">variances</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">results</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">variances</span><span class="p">,</span> <span class="n">rmses</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">window_size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">window_sizes</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">variances</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rmses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s1">°C&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Average Variance&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Average RMS&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot for heating data</span>
<span class="n">plot_rms_vs_variance</span><span class="p">(</span><span class="n">results_heat</span><span class="p">,</span> <span class="s1">&#39;Heating Data: Average RMS vs Average Variance&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ca1dd4251cec932813e17e71025997ba4386b6cda7105454494ff925803b5a55.png" src="_images/ca1dd4251cec932813e17e71025997ba4386b6cda7105454494ff925803b5a55.png" />
<img alt="_images/ed8251957ae2ba92d9cc6b5a5e76eea9114c658a007bf675da660776964a11bb.png" src="_images/ed8251957ae2ba92d9cc6b5a5e76eea9114c658a007bf675da660776964a11bb.png" />
</div>
</div>
</section>
<section id="plot-the-first-and-second-derivatives-of-the-k-t-data">
<h2>7. Plot the first and second derivatives of the <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> data<a class="headerlink" href="#plot-the-first-and-second-derivatives-of-the-k-t-data" title="Link to this heading">#</a></h2>
<p>Plotting the first and second derviatives of the data can help define practical Curie Temperatures for the phases in a specimen. For the first derviative one looks for the maximum in the derivative. In the second derivative, one looks for the zero crossing points. The second derivative can often be noisy and hard to work with. NB. The temperatures defined this way are only an estimate of the Curie Temperature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Created dataframes from the smoothed data</span>

<span class="n">df_hsmoothed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">avg_temp_heat</span><span class="p">,</span>
    <span class="s1">&#39;susc&#39;</span><span class="p">:</span> <span class="n">avg_chi_heat</span>
<span class="p">})</span>

<span class="n">df_csmoothed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">avg_temp_cool</span><span class="p">,</span>
    <span class="s1">&#39;susc&#39;</span><span class="p">:</span> <span class="n">avg_chi_cool</span>
<span class="p">})</span>

<span class="c1"># ----------------------------------------------------------------------------------------------------------------</span>
<span class="c1"># Calculate first order derivative</span>
<span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_susc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;susc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_kT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_susc&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_temp&#39;</span><span class="p">]</span>
<span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_tstep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_temp&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_susc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;susc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_kT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_susc&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_temp&#39;</span><span class="p">]</span>
<span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_tstep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_temp&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create a plot for the &#39;heat&#39; dataset with red points and a line</span>
<span class="n">fig_dheat</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Add heat data as a scatter plot with red points and lines</span>
<span class="n">fig_dheat</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_tstep&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_kT&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Heating (smoothed) - 1st Derivative&#39;</span>
<span class="p">))</span>

<span class="c1"># Create a scatter plot for the &#39;cooling&#39; dataset with blue points and a line</span>
<span class="n">fig_dcool</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Add cooling data as a scatter plot with blue points and lines</span>
<span class="n">fig_dcool</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_tstep&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_kT&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cooling (smoothed) - 1st Derivative&#39;</span>
<span class="p">))</span>

<span class="c1"># Combine the two figures</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fig_dheat</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">fig_dcool</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">900</span>  <span class="c1"># Adjust the width to your preference</span>
<span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mf">1.618</span><span class="p">)</span>  <span class="c1"># Calculate height based on the golden ratio</span>

<span class="c1"># Update the layout with a unified title and labels</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_specimen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Center the title</span>
        <span class="s1">&#39;xanchor&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span>
    <span class="p">},</span>
    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Temperature (&amp;deg;C)&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;&lt;i&gt;dk/dT&lt;/i&gt; (m&lt;sup&gt;3&lt;/sup&gt; kg&lt;sup&gt;-1&lt;/sup&gt;)&#39;</span><span class="p">,</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>  <span class="c1"># Background color of the entire plot</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>   <span class="c1"># Background color of the plotting area</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Roboto, sans-serif&#39;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Black&quot;</span>
    <span class="p">),</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Start at 0</span>
        <span class="n">dtick</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># Tick every 100 units</span>
        <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>  <span class="c1"># Color of the grid lines</span>
        <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the grid lines</span>
        <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show x-axis line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the x-axis line</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>  <span class="c1"># Color of the x-axis line</span>
    <span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="c1"># Automatic tick marks on the y-axis</span>
        <span class="n">autorange</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Reversed for easier reading</span>
        <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.1e&#39;</span><span class="p">,</span>  <span class="c1"># Scientific notation format</span>
        <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>  <span class="c1"># Color of the grid lines</span>
        <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the grid lines</span>
        <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show y-axis line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the y-axis line</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>  <span class="c1"># Color of the y-axis line</span>
    <span class="p">),</span>
        <span class="n">shapes</span><span class="o">=</span><span class="p">[</span>
        <span class="c1"># Frame around the plot</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span><span class="p">,</span>
            <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span>
            <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust left margin</span>
        <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust right margin</span>
        <span class="n">b</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust bottom margin</span>
        <span class="n">t</span><span class="o">=</span><span class="mi">80</span>   <span class="c1"># Adjust top margin for title</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot first order derviative</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># -----------------------------------------------------------------------------------------------------------------</span>
<span class="c1"># Calculate second order derivative</span>
<span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_susc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;susc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_kT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_susc&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_temp&#39;</span><span class="p">]</span>
<span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_tstep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_temp&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_susc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;susc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_kT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_susc&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_temp&#39;</span><span class="p">]</span>
<span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_tstep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;first_derivative_temp&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create a plot for the &#39;heat&#39; dataset with red points and a line</span>
<span class="n">fig_d2heat</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Add heat data as a scatter plot with red points and lines</span>
<span class="n">fig_d2heat</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_tstep&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_kT&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Heating (smoothed) - 2nd Derivative&#39;</span>
<span class="p">))</span>

<span class="c1"># Create a scatter plot for the &#39;cooling&#39; dataset with blue points and a line</span>
<span class="n">fig_d2cool</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Add cooling data as a scatter plot with blue points and lines</span>
<span class="n">fig_d2cool</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_tstep&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_csmoothed</span><span class="p">[</span><span class="s1">&#39;second_derivative_kT&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cooling (smoothed) - 2nd Derivative&#39;</span>
<span class="p">))</span>

<span class="c1"># Combine the two figures</span>
<span class="n">figd2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fig_d2heat</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">fig_d2cool</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">900</span>  <span class="c1"># Adjust the width to your preference</span>
<span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mf">1.618</span><span class="p">)</span>  <span class="c1"># Calculate height based on the golden ratio</span>

<span class="c1"># Update the layout with a unified title and labels</span>
<span class="n">figd2</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_specimen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Center the title</span>
        <span class="s1">&#39;xanchor&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span>
    <span class="p">},</span>
    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Temperature (&amp;deg;C)&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;&lt;i&gt;dk/dT&lt;/i&gt; (m&lt;sup&gt;3&lt;/sup&gt; kg&lt;sup&gt;-1&lt;/sup&gt;)&#39;</span><span class="p">,</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>  <span class="c1"># Background color of the entire plot</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>   <span class="c1"># Background color of the plotting area</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Roboto, sans-serif&#39;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Black&quot;</span>
    <span class="p">),</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Start at 0</span>
        <span class="n">dtick</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># Tick every 100 units</span>
        <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>  <span class="c1"># Color of the grid lines</span>
        <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the grid lines</span>
        <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show x-axis line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the x-axis line</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>  <span class="c1"># Color of the x-axis line</span>
    <span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="c1"># Automatic tick marks on the y-axis</span>
        <span class="n">autorange</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Reversed for easier reading</span>
        <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.1e&#39;</span><span class="p">,</span>  <span class="c1"># Scientific notation format</span>
        <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>  <span class="c1"># Color of the grid lines</span>
        <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the grid lines</span>
        <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show y-axis line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the y-axis line</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>  <span class="c1"># Color of the y-axis line</span>
    <span class="p">),</span>
        <span class="n">shapes</span><span class="o">=</span><span class="p">[</span>
        <span class="c1"># Frame around the plot</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span><span class="p">,</span>
            <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span>
            <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust left margin</span>
        <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust right margin</span>
        <span class="n">b</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust bottom margin</span>
        <span class="n">t</span><span class="o">=</span><span class="mi">80</span>   <span class="c1"># Adjust top margin for title</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot first order derviative</span>
<span class="n">figd2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="5eb9b7f4-4909-44ae-a386-cbf193b7460f" class="plotly-graph-div" style="height:556px; width:900px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5eb9b7f4-4909-44ae-a386-cbf193b7460f")) {                    Plotly.newPlot(                        "5eb9b7f4-4909-44ae-a386-cbf193b7460f",                        [{"line":{"color":"red"},"marker":{"color":"red"},"mode":"lines+markers","name":"Heating (smoothed) - 1st Derivative","x":[null,47.783333333333346,52.83333333333336,55.96363636363638,63.61083916083919,64.96510989010991,67.86214285714289,74.89980392156865,80.13328173374613,90.41929824561406,94.66111111111113,100.17222222222225,101.05964912280704,107.88684210526318,112.97894736842106,117.94210526315791,118.96565789473685,125.14250000000001,126.18,132.20952380952386,136.92619047619053,141.69761904761907,146.33809523809526,151.14761904761912,155.77142857142866,160.42857142857144,165.0261904761905,169.70952380952394,174.40000000000006,179.09523809523813,183.77857142857147,188.55714285714288,193.3047619047619,198.06666666666672,202.81666666666666,207.63333333333338,212.45,217.2452380952381,222.0809523809524,226.89047619047616,231.73333333333335,236.55952380952374,241.38095238095235,246.19761904761907,251.00238095238095,255.90476190476193,260.7333333333334,265.6261904761905,270.47380952380956,275.3809523809524,280.2857142857143,285.19285714285706,289.9833333333333,294.79047619047617,299.6333333333333,304.41666666666663,309.1952380952381,314.0023809523809,318.7595238095238,323.5595238095239,328.34285714285716,333.1214285714286,337.8452380952382,342.602380952381,347.30476190476196,352.01666666666677,356.6380952380953,361.2761904761905,365.954761904762,373.9870129870131,377.37727272727284,381.96818181818185,386.50227272727284,391.1068181818182,395.659090909091,400.175,404.70000000000016,409.21363636363645,413.68409090909097,418.1227272727273,419.19249011857715,424.6869565217392,429.13478260869573,433.5,437.85434782608695,442.1347826086958,446.48913043478257,450.7826086956522,458.23586956521734,461.48958333333326,462.5584239130435,471.03885869565204,471.10226449275353,479.5339673913043,482.6625,483.73940217391305,492.0410326086957,495.1583333333333,499.26666666666654,503.3979166666665,504.4123333333332,509.54799999999994,516.7529999999999,516.7256666666665,525.0095,524.9288333333334,530.0179999999998,537.2445,537.2058333333334,542.328,546.4319999999999,550.4300000000001,554.486,558.528,562.5840000000002,566.6000000000001,570.586,574.5740000000001,578.5360000000001,582.5559999999999,586.53,590.508,594.47,598.4740000000002,602.454,606.3659999999999,613.2394615384615,613.2888461538462,618.2,622.0799999999998,626.046,629.9179999999999,636.6861538461535,636.7106153846154,644.4233846153844,647.2211538461538,651.1326923076923,655.0000000000001,658.7596153846155,656.8615384615385,662.6004807692309,663.5921195652174,665.5198616600792,667.4762987012989,669.3638095238096,668.4100000000001,674.1366666666668,672.2277777777779,675.1287581699347,677.0034926470589,678.8968750000001,680.832142857143],"y":[null,null,-0.0003251815181518145,-0.0003009348441926468,-0.00027119047619048015,-0.0002485236768802096,-0.00023510690386814004,-0.0002191913597341407,-0.00023974550898204244,-0.00019331012101953844,-0.0002723735408560272,-0.0002798804780876515,-0.0001321522309711108,-0.00020058823529411703,-0.00020152284263960532,-0.0001998955067920767,-7.922656859466974e-05,-0.00011009174311926296,-6.742734343019577e-05,-6.137040714995685e-05,-9.206827309238707e-05,-8.429999999996162e-05,-3.6927772126155894e-05,-3.086913086914003e-05,-2.24260958205869e-05,-1.4198161389165441e-05,-6.185567010298295e-06,-3.9121552604682296e-05,6.917599186140688e-06,9.106598984770228e-05,1.991869918701575e-05,0.00010270812437312456,0.00010842527582744829,7.527527527531605e-05,8.046092184366775e-05,8.440913604767811e-05,0.00012643564356434658,9.255952380952694e-05,0.0001333662388943836,0.00013649851632046377,6.295566502462776e-05,0.00014122287968443284,0.0001433366238894358,0.00010701581027667886,0.00010831683168318406,0.0001454545454545258,0.00014670599803343358,0.00010839843750000145,0.00018411764705880614,0.00014518013631938575,6.95821185617118e-05,6.88349514563078e-05,0.00010641025641025732,2.9574678536090527e-05,2.8275862068978593e-05,2.7182539682537617e-05,6.398009950248428e-05,2.430555555555282e-05,2.3053892215568785e-05,-5.4671968190849446e-05,-1.751243781093741e-05,-1.862549800798729e-05,-1.9779116465869106e-05,1.8036072144303408e-05,1.7457114026222792e-05,1.7171717171733755e-05,1.699078812692477e-05,-2.2358974358982642e-05,5.7040816326530213e-05,0.000103207417152157,5.906374501991692e-05,9.890873015871986e-05,0.00013986013986015626,0.00014142715559959548,0.00022101593625498941,0.00022577733199599415,0.00026767068273091083,0.0002337022132796764,0.00031752786220871676,0.0003235714285714344,0.0003883743930947787,0.0003998021760633021,0.0003656526005888271,0.00045074331020811796,0.0004581673306773061,0.00043178607467206067,0.0004363727454909866,0.00048546922300705606,0.0004209554248218079,0.0004524685382381444,0.0004601113642115843,0.00037319320799795584,0.00043989793357316096,0.00025243766600975125,0.00020238095238095434,0.0004249935848088188,-0.00018617005835048768,-0.00023006012024049467,-0.00041707070707072675,-0.0007169525731584146,-0.0022145501786294246,-0.001566407010710776,-0.0016427745976887302,-0.0057254494932986386,-0.0028311898747782837,-0.007144726038735105,-0.004257923228346638,-0.003611039045201647,-0.006445320754716708,-0.004384926686217007,-0.004402214634146438,-0.004511924603174559,-0.004483399209486169,-0.004479515331355125,-0.00446015794669284,-0.004518083416087357,-0.004545260000000132,-0.004508957915831586,-0.004449456193353498,-0.004327252747252851,-0.0042677409638553765,-0.004151467336683397,-0.004044667338709719,-0.0038212625250500245,-0.0035948895582329993,-0.0032500914634146995,-0.001934181609375393,-0.0036999183673469254,-0.001252771573604044,-0.000560637948717967,-0.0002788742393509074,-9.23100616016436e-05,-8.49716176859961e-05,-7.039492753622726e-05,-7.532575556381911e-05,-7.418439716311788e-05,-7.445680238331644e-05,-8.618588469184688e-05,-6.313171225937179e-05,null,-6.815095920247881e-05,8.72111516512358e-07,-4.147179854642143e-05,-8.347571952438644e-05,-0.00014888017973041322,null,-7.910768335273456e-05,null,-0.000103813450490032,-0.00018286396274014993,-0.00012815357535753106,-0.00019647038413878585],"type":"scatter"},{"line":{"color":"blue"},"marker":{"color":"blue"},"mode":"lines+markers","name":"Cooling (smoothed) - 1st Derivative","x":[null,678.3833333333334,676.7783625730996,677.5763157894738,675.1593421052632,673.5567857142858,671.9316017316019,670.2958498023717,668.6570652173914,667.0075000000002,667.8300000000002,665.3503846153847,663.6920940170942,661.9612433862435,660.3023399014779,658.6201724137933,656.8804838709679,652.9016129032259,649.5887096774195,646.4648498331482,642.9172413793106,639.446551724138,635.9810344827588,632.5137931034483,629.0172413793105,622.9019704433501,620.207142857143,616.5892857142858,613.0178571428573,609.3964285714285,605.7625,602.1267857142859,598.4196428571429,592.0224206349205,589.162962962963,585.4314814814816,581.675925925926,580.7634615384616,576.0038461538463,572.1884615384615,568.3288461538461,564.55,560.6519230769229,556.7576923076922,552.8442307692308,548.9346153846152,545.0153846153846,541.1288461538461,537.1519230769231,533.1730769230769,526.2121538461538,526.2279999999998,518.0506666666665,518.1344999999999,512.96875,508.8520833333333,504.7458333333333,500.61249999999984,496.4625,492.26458333333335,488.09791666666666,483.86458333333326,479.6208333333334,472.30625000000015,472.2125000000001,463.766123188406,460.4717391304347,456.15869565217395,451.87173913043466,447.5043478260869,443.1347826086957,438.8,434.4695652173914,430.0891304347827,429.02776679841907,420.2117588932807,420.221837944664,411.3941699604743,408.05,403.608695652174,399.1173913043478,394.6695652173914,393.5942687747036,387.9659090909091,380.14871541501975,373.3807312252965,376.75454545454545,363.17954545454563,367.70454545454555,357.50098814229256,357.5170948616602,351.83409090909095,347.30681818181824,339.3386363636365,335.87857142857143,334.7313852813853,329.0386363636365,321.02305194805194,320.9976190476191,308.45227272727277,313.01818181818186,302.7587662337662,299.2857142857142,294.6833333333333,290.0904761904762,285.4880952380952,280.8166666666666,276.1761904761904,271.60476190476203,266.9809523809524,265.8695887445887,256.699025974026,249.8889610389611,246.46590909090912,241.89318181818186,237.3318181818183,232.76136363636368,228.1863636363637,223.6204545454546,219.08636363636361,214.52727272727276,209.9863636363636,205.50227272727267,204.41511857707508,198.8173913043479,194.35000000000002,189.92608695652171,185.4608695652174,181.05000000000007,176.61739130434788,172.22608695652178,167.8347826086957,163.4586956521739,159.10869565217394,151.6554347826087,148.49791666666667,144.20833333333337,140.00833333333338,135.8458333333333,131.7,124.63941666666668,124.53824999999998,116.58525,113.60400000000004,109.71200000000006,103.13415384615391,103.28461538461545,98.54444444444451,92.3843915343916,87.2894088669951,84.65172413793108,79.10258620689658,78.76005747126437,79.6844827586207,74.26609195402303,76.07222222222225,73.40235042735046,71.64884615384616,69.92875000000004,70.79583333333336,68.2096920289855,66.50276679841899,64.75259740259743,65.6214285714286,63.151785714285715,63.97500000000001,61.53750000000002,59.92500000000004,60.73333333333336],"y":[null,-0.0001685772576636285,-0.00022873048735801098,null,-3.917867058631382e-05,-0.00011061708438380317,-5.74245787643766e-05,-1.1360451018428913e-05,-0.00016814186046511733,-2.250060790273606e-05,null,-7.373950674731901e-05,-3.401590850460381e-05,-0.0001473942471700971,-3.740630975143411e-05,-7.987689044002204e-05,-3.42675545551166e-05,-5.560999999999981e-05,-0.00011689096267190683,-0.00018955697930889907,-7.308962739174281e-05,-6.383233532933898e-05,-5.6733067729083925e-05,-1.2059701492536992e-05,-5.588526211671417e-06,-4.009238363892941e-05,-0.00012053427419354705,-0.0001880715705765343,-0.0005728343313373443,-0.0012502574257425233,-0.0019625123152709353,-0.002677305801376675,-0.0032716197866148656,-0.0028225151128344144,-0.004044281466798849,-0.004205009920635027,-0.004305345849802339,-0.001977204202131716,-0.004436592292089303,-0.004422999999999925,-0.004424854854854824,-0.004446831983805596,-0.004410248756218869,-0.004356128712871313,-0.004343182266009948,-0.0043842125984250874,-0.004345795677799621,-0.004417966436327706,-0.004325141187926069,-0.004237015503875978,-0.005045390826540085,-0.007042568273769235,-0.0033668036766309963,-0.007418392226148426,-0.0038404568527919225,-0.003180344478216848,-0.002414604462474619,-0.0015973737373737372,-0.0009436619718309922,-0.0004832502492522668,-0.00022617382617384302,-7.922848664686238e-05,2.5590551181086684e-05,6.424928688737792e-05,0.0002263471546079879,0.0001212785987333766,0.00017227822580645943,0.00016391129032259472,0.00015404858299591885,0.0002228228228228592,0.0002531405782652008,0.00028458458458459243,0.0002775325977933879,0.00019282868525895223,0.00030115142099973496,0.00024512834336718473,0.00015872915727808276,0.00025008513307640915,0.00027460784313727095,0.00023232125367286566,0.00022701652089409044,0.00022370731707317676,0.00022499102656138104,0.0002252279635258271,0.00020888705542622299,0.00020571713089067214,null,0.0002137619286790595,null,0.0001976873910517085,0.000252088624222793,0.00021001001001002466,0.00017141424272818398,0.00013857745629896858,0.00017723492723491875,0.00010090668681528439,0.00021026919242272043,0.00015771862878045923,0.00014091848234410112,0.0001560477849676589,null,0.00012597867021108504,0.00010559585492229082,0.00014658385093168152,0.00014808290155438956,0.00014917184265008531,0.00014877049180330083,0.0001894358974359128,0.00011233160621761372,0.00015221878224971696,0.00010128217304587405,0.00011807274444970215,0.00015301330798478654,0.00010967098703888338,0.00014706467661691132,0.00010776892430279515,0.00014457711442784823,0.00014294234592446322,0.00010238805970148956,0.00013890000000002045,0.00013632734530937528,5.6399999999981476e-05,0.00013097880928357133,9.523302263648949e-05,8.26044703595449e-05,4.1050583657587005e-05,7.443682664055932e-05,6.887804878049816e-05,2.6522593320240786e-05,-1.7271835132491913e-05,-2.2704837117495533e-05,-2.868447082096504e-05,3.5714285714122893e-06,-2.891326021933782e-06,-8.728421527699724e-05,-5.5839057899901547e-05,-6.354775828461451e-05,-0.00010828402366859968,-0.000114641434262942,-0.00016002004008015412,-0.00022426488689513798,-8.983400841875047e-05,-0.00020626232330805665,-0.0002618856569709288,-0.00022986748216106495,-0.00031341404096633154,-0.0003782849896972529,-0.00031044334975369116,-0.0003007280355380033,-0.0003202599315719253,-0.0003546983184965269,-0.00036588958505734767,-0.00029199253963318333,null,-0.0002797164474614911,null,-0.00026094437775111304,-0.0003615800960278904,-0.00038557424315239364,null,-0.00040969843438057237,-0.00033474498038308655,-0.00045589187842556405,null,-0.0003895733911786345,null,-0.0004184453441295196,-0.00044981009224089296,null],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"360-U1473A-84R-1-W-143-r4","x":0.5,"xanchor":"center"},"font":{"family":"Roboto, sans-serif","size":18,"color":"Black"},"xaxis":{"title":{"text":"Temperature (&deg;C)"},"tick0":0,"dtick":100,"gridcolor":"lightgray","gridwidth":1,"showline":true,"linewidth":1,"linecolor":"black"},"yaxis":{"title":{"text":"<i>dk/dT</i> (m<sup>3</sup> kg<sup>-1</sup>)"},"autorange":true,"tickformat":".1e","gridcolor":"lightgray","gridwidth":1,"showline":true,"linewidth":1,"linecolor":"black"},"margin":{"l":50,"r":50,"b":50,"t":80},"width":900,"height":556,"showlegend":true,"paper_bgcolor":"white","plot_bgcolor":"white","shapes":[{"line":{"color":"black","width":2},"type":"rect","x0":0,"x1":1,"xref":"paper","y0":0,"y1":1,"yref":"paper"}]},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5eb9b7f4-4909-44ae-a386-cbf193b7460f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div><div class="output text_html"><div>                            <div id="e3ae7d8d-b265-46d6-8b93-3b9e29ef4d3b" class="plotly-graph-div" style="height:556px; width:900px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e3ae7d8d-b265-46d6-8b93-3b9e29ef4d3b")) {                    Plotly.newPlot(                        "e3ae7d8d-b265-46d6-8b93-3b9e29ef4d3b",                        [{"line":{"color":"red"},"marker":{"color":"red"},"mode":"lines+markers","name":"Heating (smoothed) - 2nd Derivative","x":[null,47.783333333333346,52.83333333333336,55.96363636363638,63.61083916083919,64.96510989010991,67.86214285714289,74.89980392156865,80.13328173374613,90.41929824561406,94.66111111111113,100.17222222222225,101.05964912280704,107.88684210526318,112.97894736842106,117.94210526315791,118.96565789473685,125.14250000000001,126.18,132.20952380952386,136.92619047619053,141.69761904761907,146.33809523809526,151.14761904761912,155.77142857142866,160.42857142857144,165.0261904761905,169.70952380952394,174.40000000000006,179.09523809523813,183.77857142857147,188.55714285714288,193.3047619047619,198.06666666666672,202.81666666666666,207.63333333333338,212.45,217.2452380952381,222.0809523809524,226.89047619047616,231.73333333333335,236.55952380952374,241.38095238095235,246.19761904761907,251.00238095238095,255.90476190476193,260.7333333333334,265.6261904761905,270.47380952380956,275.3809523809524,280.2857142857143,285.19285714285706,289.9833333333333,294.79047619047617,299.6333333333333,304.41666666666663,309.1952380952381,314.0023809523809,318.7595238095238,323.5595238095239,328.34285714285716,333.1214285714286,337.8452380952382,342.602380952381,347.30476190476196,352.01666666666677,356.6380952380953,361.2761904761905,365.954761904762,373.9870129870131,377.37727272727284,381.96818181818185,386.50227272727284,391.1068181818182,395.659090909091,400.175,404.70000000000016,409.21363636363645,413.68409090909097,418.1227272727273,419.19249011857715,424.6869565217392,429.13478260869573,433.5,437.85434782608695,442.1347826086958,446.48913043478257,450.7826086956522,458.23586956521734,461.48958333333326,462.5584239130435,471.03885869565204,471.10226449275353,479.5339673913043,482.6625,483.73940217391305,492.0410326086957,495.1583333333333,499.26666666666654,503.3979166666665,504.4123333333332,509.54799999999994,516.7529999999999,516.7256666666665,525.0095,524.9288333333334,530.0179999999998,537.2445,537.2058333333334,542.328,546.4319999999999,550.4300000000001,554.486,558.528,562.5840000000002,566.6000000000001,570.586,574.5740000000001,578.5360000000001,582.5559999999999,586.53,590.508,594.47,598.4740000000002,602.454,606.3659999999999,613.2394615384615,613.2888461538462,618.2,622.0799999999998,626.046,629.9179999999999,636.6861538461535,636.7106153846154,644.4233846153844,647.2211538461538,651.1326923076923,655.0000000000001,658.7596153846155,656.8615384615385,662.6004807692309,663.5921195652174,665.5198616600792,667.4762987012989,669.3638095238096,668.4100000000001,674.1366666666668,672.2277777777779,675.1287581699347,677.0034926470589,678.8968750000001,680.832142857143],"y":[null,null,-0.0003251815181518145,-0.0008189743589740762,-0.0002389293311273881,-0.0002920896567826488,-0.0011992882562256745,-0.0002022854054274289,0.00016560074734139785,-0.00011701424291794757,-3.96517412935394e-05,4.1666666666942005e-05,-0.0003956704694221237,-0.0002580777710964262,-0.00017428571428537612,-0.0002571428571426411,-0.00030639323300879023,-0.00013874405131388055,-0.00014859174439006958,-5.566165123459281e-05,0.002718181818182554,0.0018500000000190387,-0.002823529411763185,0.0003000000000001036,-0.00044500000000076824,-0.004049999999963797,-0.0008777777777792932,-0.0035888888888834496,0.011275000000036487,0.04144999999998978,0.07010000000014627,0.0063692307692313575,null,-0.01644999999985779,-0.0050999999998605034,0.000522222222225116,0.014233333333391083,0.01720000000008908,0.008360000000003379,-0.0014499999999838197,-0.018524999999963224,-0.07929999999927732,-0.0020000000000019585,0.036900000000315326,-0.0005500000000042806,0.003030769230764724,-6.666666667047577e-05,-0.005457142857152777,-0.01919999999998796,-0.005528571428563042,-0.03875000000010538,-0.0007000000000064162,-0.0023125000000011366,0.026000000000072337,-0.0002999999999944231,0.0001857142857166229,-0.012299999999982754,-0.013266666666648328,0.00023333333333260074,-0.019524999999875097,-0.03739999999920844,0.0011000000000300665,0.00012499999999846122,0.018850000000172045,0.00010000000000407674,0.0002999999999711084,3.076923077006855e-05,0.01919999999994232,0.015539999999967986,0.00019922824618944348,0.0001890518354546968,0.010100000000007351,-0.005757142857152027,0.00033749999999710563,-0.015840000000018034,-0.0004571428571418032,-0.04150000000106336,0.017149999999798573,-0.01158571428570453,-0.0005285714285725172,0.00026044841478367316,0.0004112320143884749,-0.0039499999999982075,-0.008219999999986783,-0.0010400000000068998,0.0024692307692342004,0.0010857142857162998,-0.006514285714303871,0.00028835983408226595,0.000356393894972819,0.00044485973458761603,0.00032898824337081233,0.00033883478410756305,0.0001552688638334521,0.0003505452700988585,-2.4066823283721235e-05,-0.0005001582000351182,-9.851213782293234e-05,0.02291249999998199,-0.29760000000023523,0.0007634561361265403,-0.0009191047680829999,-0.0017947206974491966,0.0003715645161290169,-0.001413375770678156,-0.0007574932357154305,-0.001422745894976625,-0.0023641122529640918,-0.0022203654805989276,-0.0023532001294289764,-0.013245000000133924,0.0021029411764746726,0.002705000000004985,-0.008409999999953266,0.005324999999906308,0.005261666666640652,-0.0006357142857097052,-0.022660000000533104,-0.016325999999923273,0.010841250000025284,-0.016182000000108093,-0.11995999999942256,-0.03946666666647745,0.03311499999984269,-0.11655499999778621,-0.03186833333333195,0.0007106638384790248,-0.001028934775742248,0.0012641552475247302,-0.06873579999967196,0.02469563636351835,-0.015421666666629549,-7.00400128555394e-05,-9.235239690516704e-05,-7.783404118920235e-05,-7.749564681409316e-05,-8.79000000001326e-05,0.011725000000170273,-0.001283789473682905,-6.313171225937179e-05,-6.815095920247881e-05,-0.00013888593890584264,0.014143014245274926,-0.004797404813976521,0.0030189063508969743,-0.00014888017973041322,-7.910768335273456e-05,-7.910768335273456e-05,-0.000103813450490032,0.003687422957603241,-0.1410894666777014,-0.004870662365602326],"type":"scatter"},{"line":{"color":"blue"},"marker":{"color":"blue"},"mode":"lines+markers","name":"Cooling (smoothed) - 2nd Derivative","x":[null,678.3833333333334,676.7783625730996,677.5763157894738,675.1593421052632,673.5567857142858,671.9316017316019,670.2958498023717,668.6570652173914,667.0075000000002,667.8300000000002,665.3503846153847,663.6920940170942,661.9612433862435,660.3023399014779,658.6201724137933,656.8804838709679,652.9016129032259,649.5887096774195,646.4648498331482,642.9172413793106,639.446551724138,635.9810344827588,632.5137931034483,629.0172413793105,622.9019704433501,620.207142857143,616.5892857142858,613.0178571428573,609.3964285714285,605.7625,602.1267857142859,598.4196428571429,592.0224206349205,589.162962962963,585.4314814814816,581.675925925926,580.7634615384616,576.0038461538463,572.1884615384615,568.3288461538461,564.55,560.6519230769229,556.7576923076922,552.8442307692308,548.9346153846152,545.0153846153846,541.1288461538461,537.1519230769231,533.1730769230769,526.2121538461538,526.2279999999998,518.0506666666665,518.1344999999999,512.96875,508.8520833333333,504.7458333333333,500.61249999999984,496.4625,492.26458333333335,488.09791666666666,483.86458333333326,479.6208333333334,472.30625000000015,472.2125000000001,463.766123188406,460.4717391304347,456.15869565217395,451.87173913043466,447.5043478260869,443.1347826086957,438.8,434.4695652173914,430.0891304347827,429.02776679841907,420.2117588932807,420.221837944664,411.3941699604743,408.05,403.608695652174,399.1173913043478,394.6695652173914,393.5942687747036,387.9659090909091,380.14871541501975,373.3807312252965,376.75454545454545,363.17954545454563,367.70454545454555,357.50098814229256,357.5170948616602,351.83409090909095,347.30681818181824,339.3386363636365,335.87857142857143,334.7313852813853,329.0386363636365,321.02305194805194,320.9976190476191,308.45227272727277,313.01818181818186,302.7587662337662,299.2857142857142,294.6833333333333,290.0904761904762,285.4880952380952,280.8166666666666,276.1761904761904,271.60476190476203,266.9809523809524,265.8695887445887,256.699025974026,249.8889610389611,246.46590909090912,241.89318181818186,237.3318181818183,232.76136363636368,228.1863636363637,223.6204545454546,219.08636363636361,214.52727272727276,209.9863636363636,205.50227272727267,204.41511857707508,198.8173913043479,194.35000000000002,189.92608695652171,185.4608695652174,181.05000000000007,176.61739130434788,172.22608695652178,167.8347826086957,163.4586956521739,159.10869565217394,151.6554347826087,148.49791666666667,144.20833333333337,140.00833333333338,135.8458333333333,131.7,124.63941666666668,124.53824999999998,116.58525,113.60400000000004,109.71200000000006,103.13415384615391,103.28461538461545,98.54444444444451,92.3843915343916,87.2894088669951,84.65172413793108,79.10258620689658,78.76005747126437,79.6844827586207,74.26609195402303,76.07222222222225,73.40235042735046,71.64884615384616,69.92875000000004,70.79583333333336,68.2096920289855,66.50276679841899,64.75259740259743,65.6214285714286,63.151785714285715,63.97500000000001,61.53750000000002,59.92500000000004,60.73333333333336],"y":[null,null,-0.005464001897544159,-0.00022873048735801098,-3.917867058631382e-05,0.01960132618039019,0.006442489291619732,0.006514795716633128,-0.0440031610170636,0.02607155714286661,-2.250060790273606e-05,-7.373950674731901e-05,0.018858462296342825,-0.003939233566131202,-0.006003199245925986,-0.01423465522892974,0.001879866777835387,-7.99785107446292e-05,-0.003521388888892083,0.0020474045881122174,0.0014254045045043024,0.0009575555555519045,0.0035000000000566275,0.044839999998511536,0.001078333333345011,-0.0001087218943226562,0.0001279407493465157,-0.004973571428564611,0.09619499999833761,-0.08609749999919737,-0.14583800000119368,-0.3654350000053185,-0.04644428571411653,-0.0019089133294358147,-0.00022116286080337564,0.15796999999744904,-0.029589999999750073,-0.006593138422123411,-0.006798191591193824,-0.0010724999999938054,-0.0046288888888939604,-0.0024509090909104426,-0.002284117647059423,0.0065220000000171564,-0.001728000000006998,-0.04602999999793502,0.015170000000222046,0.010276000000030655,0.002391428571433724,0.013863999999954855,-0.006654159981487143,-0.004054741072117777,-0.0016083653225806296,-0.0014232577286302072,-0.0005020990658607719,0.3219250000003001,-0.7582000000110444,0.19984999999949046,0.1608500000012514,0.050366666666633024,-0.12915000000099852,0.014629999999997265,0.021220000000069666,0.00014391921686221048,-2.0479971921178475e-05,6.718236819361136e-05,1.3311399608697554e-05,211616150.96907553,0.0026000000000276544,0.006400000000025075,0.007824999999990367,-0.007600000000028987,0.003799999999977233,-0.011871428571420675,8.646926873033757e-05,0.00021781322402424205,0.0002881302709492169,0.0002953712804931949,0.0002002265108270911,-0.04290000000030469,-0.00044999999999491085,0.001074999999997717,0.0002224530948623624,0.0002254564333304292,0.00017587219651120814,-0.0003165048543673518,0.00020571713089067214,0.0002137619286790595,0.0002137619286790595,0.0001976873910517085,0.00017067953567235093,0.00016843744592492428,0.019450000000025208,7.362055933482309e-05,5.958289079848453e-05,0.00025364977307106224,0.0003208114558472117,5.374788653014242e-05,0.00016621243055883338,0.0001611553216448614,0.0001560477849676589,0.00012597867021108504,0.0001677114475841303,0.039700000000097435,-0.0012999999999680869,0.0011999999999866826,0.00011000000000390977,-0.03950000000009727,0.007629999999976602,0.009774999999904634,0.00020192788951705061,0.00012640158296430262,-0.00553692307692111,0.00023998285224348606,0.018900000000015,0.03959999999953155,0.037099999999321065,-0.0014999999999789945,0.04089999999979516,-0.007200000000020533,-0.001150000000022432,0.040100000000292894,-0.00815555555555585,0.00016590909090912363,7.009584102693416e-05,0.042800000000533196,-0.0048285714285779486,-0.0013500000000025228,0.006228571428560986,-0.04459999999943351,0.000900000000002339,0.0029999999999865174,-0.010866666666684066,0.001299999999993312,-0.0002657996485061571,-0.00014862255513941813,-0.0011857142857174222,0.003716666666663417,0.0005300000000039542,0.00743333333332304,-0.00036233956413123493,-0.0002948848464619027,-0.0002688615594841295,-9.60930386556951e-05,-0.002225000000000909,-0.0004987130434782528,-0.00028348398155949206,-0.00024828637815858096,-0.00027790909090909054,0.00027274183546874297,-0.00024951378809865907,-0.0003942582532386839,-0.0004112399847386788,-0.00029199253963318333,-0.0002797164474614911,-0.0002797164474614911,-0.00026094437775111304,0.009811909385109402,0.0011170387243790844,-0.00038557424315239364,-0.00040969843438057237,-0.011624892086309312,-0.008750489089547621,-0.00045589187842556405,-0.0003895733911786345,-0.0003895733911786345,-0.0004184453441295196,0.005666315789472008,-0.00044981009224089296],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"360-U1473A-84R-1-W-143-r4","x":0.5,"xanchor":"center"},"font":{"family":"Roboto, sans-serif","size":18,"color":"Black"},"xaxis":{"title":{"text":"Temperature (&deg;C)"},"tick0":0,"dtick":100,"gridcolor":"lightgray","gridwidth":1,"showline":true,"linewidth":1,"linecolor":"black"},"yaxis":{"title":{"text":"<i>dk/dT</i> (m<sup>3</sup> kg<sup>-1</sup>)"},"autorange":true,"tickformat":".1e","gridcolor":"lightgray","gridwidth":1,"showline":true,"linewidth":1,"linecolor":"black"},"margin":{"l":50,"r":50,"b":50,"t":80},"width":900,"height":556,"showlegend":true,"paper_bgcolor":"white","plot_bgcolor":"white","shapes":[{"line":{"color":"black","width":2},"type":"rect","x0":0,"x1":1,"xref":"paper","y0":0,"y1":1,"yref":"paper"}]},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e3ae7d8d-b265-46d6-8b93-3b9e29ef4d3b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
</section>
<section id="calculate-tc-using-inverse-susceptibility">
<h2>8. Calculate <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> using inverse susceptibility<a class="headerlink" href="#calculate-tc-using-inverse-susceptibility" title="Link to this heading">#</a></h2>
<p>Above <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> a mineral phase will be paramagnetic. This means that the inverse susceptibility should have a linear positive slope above <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span>. Using the intercept temperature at 0 inverse susceptibility is a good guess for  <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span>. This is essentially the break of slope between the ferromagnetic and paramagnetic signal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;inverse_susc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;susc&#39;</span><span class="p">]</span>

<span class="c1"># Create a plot for the &#39;heat&#39; dataset with red points and a line</span>
<span class="n">fig_iheat</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Add heat data as a scatter plot with red points and lines</span>
<span class="n">fig_iheat</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">df_hsmoothed</span><span class="p">[</span><span class="s1">&#39;inverse_susc&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Heating (smoothed) - Inverse&#39;</span>
<span class="p">))</span>

<span class="n">fig_iheat</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_specimen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Center the title</span>
        <span class="s1">&#39;xanchor&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span>
    <span class="p">},</span>
    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Temperature (&amp;deg;C)&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Inverse &lt;i&gt;k&lt;/i&gt; (m&lt;sup&gt;-3&lt;/sup&gt; kg&lt;sup&gt;1&lt;/sup&gt;)&#39;</span><span class="p">,</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>  <span class="c1"># Background color of the entire plot</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>   <span class="c1"># Background color of the plotting area</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Roboto, sans-serif&#39;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Black&quot;</span>
    <span class="p">),</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Start at 0</span>
        <span class="n">dtick</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># Tick every 100 units</span>
        <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>  <span class="c1"># Color of the grid lines</span>
        <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the grid lines</span>
        <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show x-axis line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the x-axis line</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>  <span class="c1"># Color of the x-axis line</span>
    <span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="c1"># Automatic tick marks on the y-axis</span>
        <span class="n">autorange</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Reversed for easier reading</span>
        <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.1e&#39;</span><span class="p">,</span>  <span class="c1"># Scientific notation format</span>
        <span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span>  <span class="c1"># Color of the grid lines</span>
        <span class="n">gridwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the grid lines</span>
        <span class="n">showline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Show y-axis line</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Width of the y-axis line</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>  <span class="c1"># Color of the y-axis line</span>
    <span class="p">),</span>
        <span class="n">shapes</span><span class="o">=</span><span class="p">[</span>
        <span class="c1"># Frame around the plot</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span><span class="p">,</span>
            <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span>
            <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust left margin</span>
        <span class="n">r</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust right margin</span>
        <span class="n">b</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Adjust bottom margin</span>
        <span class="n">t</span><span class="o">=</span><span class="mi">80</span>   <span class="c1"># Adjust top margin for title</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot first order derviative</span>
<span class="n">fig_iheat</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="98932381-fa38-4e5f-b11d-d717550f823b" class="plotly-graph-div" style="height:556px; width:900px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("98932381-fa38-4e5f-b11d-d717550f823b")) {                    Plotly.newPlot(                        "98932381-fa38-4e5f-b11d-d717550f823b",                        [{"line":{"color":"red"},"marker":{"color":"red"},"mode":"lines+markers","name":"Heating (smoothed) - Inverse","x":[47.783333333333346,47.783333333333346,51.15000000000002,54.35909090909093,60.526923076923104,63.485714285714316,66.40333333333336,72.06764705882355,77.44473684210527,86.09444444444446,91.80555555555557,97.38333333333335,99.83421052631581,105.20263157894739,110.38684210526317,115.42368421052633,117.78500000000001,122.69000000000001,125.01666666666668,129.8119047619048,134.55476190476196,139.3166666666667,143.99761904761908,148.76428571428576,153.43571428571437,158.09761904761908,162.7166666666667,167.37857142857152,172.05952380952388,176.75000000000006,181.43571428571434,186.18333333333337,190.9309523809524,195.6880952380953,200.4404761904762,205.23571428571432,210.0452380952381,214.8452380952381,219.66904761904763,224.48333333333332,229.31666666666666,234.14523809523806,238.9690476190476,243.78809523809525,248.59761904761905,253.46904761904764,258.3119047619048,263.1880952380953,268.0452380952381,272.9357142857143,277.8357142857143,282.74047619047616,287.5690476190476,292.3833333333333,297.21666666666664,302.01666666666665,306.80238095238093,311.60238095238094,316.3738095238095,321.16428571428577,325.95000000000005,330.73095238095243,335.4738095238096,340.22619047619054,344.94523809523815,349.6595238095239,354.3119047619048,358.95476190476194,363.6214285714286,370.53181818181827,375.09545454545463,379.6772727272728,384.2272727272728,388.8136363636364,393.3772727272728,397.90909090909093,402.43636363636375,406.95454545454555,411.44090909090914,415.8954545454546,418.09347826086963,422.4891304347827,426.9195652173914,431.30652173913046,435.6717391304348,439.98043478260877,444.3195652173913,448.6282608695652,455.0333333333333,459.3374999999999,461.48478260869564,467.8541666666666,470.01956521739123,476.36249999999995,480.5625,482.6804347826087,488.92083333333335,493.07916666666665,497.2041666666666,501.3333333333332,503.38599999999985,507.4939999999999,513.6666666666666,515.7059999999999,521.9083333333333,523.922,527.9859999999999,534.1583333333333,536.19,540.282,544.382,548.414,552.462,556.506,560.5580000000001,564.5860000000001,568.586,572.5780000000001,576.5500000000001,580.554,584.538,588.518,592.486,596.4780000000001,600.462,604.3979999999999,610.2923076923076,612.29,616.23,620.1299999999999,624.074,627.9699999999999,633.780769230769,635.7339999999999,641.5269230769229,645.3230769230769,649.1961538461538,653.0653846153847,656.8615384615385,656.8615384615385,660.6875000000001,662.6239130434783,664.5545454545455,666.5023809523811,668.4100000000001,668.4100000000001,672.2277777777779,672.2277777777779,674.1617647058824,676.0562500000001,677.9500000000002,679.8714285714287],"y":[2.3755898952647283,2.3755898952647283,2.3817843041843423,2.3872754054011414,2.3968462370961405,2.4010780703331336,2.40503923059909,2.412242237195183,2.419766989938622,2.4295972238018355,2.4388144142711616,2.4481351018044744,2.4500778267221657,2.456559081920259,2.462879959347444,2.4690024217924975,2.4701433770021755,2.4734426463066064,2.4744028037670267,2.476205930859874,2.478886292576836,2.4813554789504666,2.482420238685179,2.4833273246666554,2.4839735505076934,2.484382021151958,2.4845583809283025,2.4856847344737707,2.485484680697417,2.482848746876089,2.48227352330346,2.479272602197181,2.4761125005443034,2.4739189159881048,2.471580851241398,2.4691107484705945,2.4654090489880653,2.4627115277169445,2.4588159164493413,2.4548493872164046,2.4530170433404774,2.4489206749463275,2.444781040345837,2.4417025210334358,2.4386005948815184,2.434394149951469,2.4301909425325454,2.427073295290462,2.421816749360753,2.417659608102213,2.4156683562502996,2.4136998014662954,2.410710082346068,2.4098829160680357,2.4090894808450027,2.408332472545612,2.40655785640695,2.405882368643434,2.4052458274053095,2.40676195587367,2.4072475207442547,2.407763648141666,2.4083076153794667,2.407810579788978,2.407333066669611,2.4068640185897925,2.406406183281314,2.4070074727151662,2.4054662364578125,2.401346517948221,2.3997931989118992,2.3971861567381,2.393534862150779,2.389824578837413,2.3840778450831857,2.378276408170435,2.3714418213207846,2.3655184991825955,2.3575739732234897,2.3495897819159897,2.3448865451623266,2.335263198224786,2.3264618988406016,2.315808426217976,2.305131938285524,2.2952884842812002,2.285356146275074,2.2744832772028767,2.2606198551824312,2.2507109714619977,2.245717219541579,2.2337930218763167,2.22905002859532,2.2211225197835387,2.2169370443085907,2.212521991386383,2.218223832685587,2.2229411378524344,2.231475157935444,2.246314527911918,2.269488609323195,2.303122735022735,2.358196903781793,2.4249672690042865,2.532820819854681,2.6286070995207993,2.7538694481923085,2.9339547710334366,3.0511791983783354,3.227899171533854,3.4275928214415394,3.6555337872580225,3.915287891510191,4.214183339731869,4.561599705576109,4.974567523535922,5.469219070991885,6.066426153091117,6.794934186305953,7.701659877140043,8.862148046436948,10.38242413406949,12.458361042804688,15.381562736010853,19.727422261133466,26.386268585827935,37.73892732614764,52.33809993855508,70.56854251966396,83.44367368450216,91.87585880959023,95.01537918927558,99.69233411962468,101.0778538018009,105.74169256660305,108.98716550371773,112.52371653717786,116.91062767067717,120.28071668802423,120.28071668802423,124.17514075769603,124.14910631535709,125.39556601278579,128.00546156636017,132.8345837495484,132.8345837495484,138.38638400991456,138.38638400991456,142.3412455528827,149.72441350139894,155.3700552185176,165.05074131361528],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"360-U1473A-84R-1-W-143-r4","x":0.5,"xanchor":"center"},"font":{"family":"Roboto, sans-serif","size":18,"color":"Black"},"xaxis":{"title":{"text":"Temperature (&deg;C)"},"tick0":0,"dtick":100,"gridcolor":"lightgray","gridwidth":1,"showline":true,"linewidth":1,"linecolor":"black"},"yaxis":{"title":{"text":"Inverse <i>k</i> (m<sup>-3</sup> kg<sup>1</sup>)"},"autorange":true,"tickformat":".1e","gridcolor":"lightgray","gridwidth":1,"showline":true,"linewidth":1,"linecolor":"black"},"margin":{"l":50,"r":50,"b":50,"t":80},"width":900,"height":556,"showlegend":true,"paper_bgcolor":"white","plot_bgcolor":"white","shapes":[{"line":{"color":"black","width":2},"type":"rect","x0":0,"x1":1,"xref":"paper","y0":0,"y1":1,"yref":"paper"}]},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('98932381-fa38-4e5f-b11d-d717550f823b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-packages">1. Install and import packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-the-data-from-a-magic-contribution">2. Import the data from a MagIC contribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-a-k-t-specimen">3. Select a <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> Specimen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#call-the-measurement-data-for-the-selected-specimen">4. Call the measurement data for the selected specimen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-heating-and-cooling-k-t-curves">5. Plot the heating and cooling <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> curves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-average-smoothing">6. Running Average Smoothing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-first-and-second-derivatives-of-the-k-t-data">7. Plot the first and second derivatives of the <span style="font-family: 'Times New Roman';"><em>k(T)</em></span> data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-tc-using-inverse-susceptibility">8. Calculate <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> using inverse susceptibility</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By RockmagPy Contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>