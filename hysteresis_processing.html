
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hysteresis Processing &#8212; RockmagPy Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'hysteresis_processing';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Resources for learning more about rock magnetism" href="book/resources.html" />
    <link rel="prev" title="Plot and analyze anisotropy data (AMS)" href="Anisotropy_plot_AMS.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="book/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/rockmagpy.png" class="logo__image only-light" alt="RockmagPy Documentation - Home"/>
    <img src="_static/rockmagpy.png" class="logo__image only-dark pst-js-only" alt="RockmagPy Documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="book/intro.html">
                    RockmagPy: tools for rock magnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Nuts &amp; Bolts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rockmag_set_up.html">Getting going with rockmag.py on JupyterHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="rockmag_data_unpack.html">Rock magnetic experiments data import</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MPMS notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot_dc.html">Plot MPMS data (DC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot_ac.html">Plot MPMS data (AC susceptibility)</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_verwey_fit.html">Estimate the Verwey transition temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_goethite_fit.html">Fit and remove the goethite component</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">VSM notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="VSM_backfield_unmixing.html">Unmixing coercivity spectra from backfield curves</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermomagnetic notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="high_T_susceptibility.html">Analysis of susceptibility-temperature, <span style="font-family: 'Times New Roman';"><em>(Kappabridge <span class="math notranslate nohighlight">\(\chi\)</span>-T)</em></span>, data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Anisotropy notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Anisotropy_plot_AMS.html">Plot and analyze anisotropy data (AMS)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hysteresis loop notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hysteresis Processing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">More resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/resources.html">Resources for learning more about rock magnetism</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks/issues/new?title=Issue%20on%20page%20%2Fhysteresis_processing.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/hysteresis_processing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hysteresis Processing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#workflow-for-hysteresis-processing">Workflow for hysteresis processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-packages">Install and import packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-data">Import data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-local-data">Load local data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#all-of-the-project-data-is-now-stored-in-the-measurements-variable">All of the project data is now stored in the <span class="math notranslate nohighlight">\(measurements\)</span> variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-original-data">Inspect the original data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-processing">Loop processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-specimen-hysteresis-data">select specimen hysteresis data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-default-hysteresis-processing-procedure-following-the-flowchart-above">execute default hysteresis processing procedure following the flowchart above</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-loop-processing-stats">inspect the loop processing stats</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manually-apply-loop-drift-correction">Manually apply loop drift correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#positive-field-correction">positive field correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upper-branch-correction">upper branch correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetric-averaging">Symmetric averaging</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hysteresis-processing">
<h1>Hysteresis Processing<a class="headerlink" href="#hysteresis-processing" title="Link to this heading">#</a></h1>
<section id="workflow-for-hysteresis-processing">
<h2>Workflow for hysteresis processing<a class="headerlink" href="#workflow-for-hysteresis-processing" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>grid the original data by averaging field step size, and interpolate both the upper and lower branches of the hysteresis loop to the same field steps.</p></li>
<li><p>perform a linear fit on the original loop data for the high field slope (typically &gt; 80% max field values and &lt; 97% max field value) and subtract the linear fit from all the gridded data points.
perform paramagnetic/diamagnetic slope correction on the gridded data. Here we use both the upper and lower branches of the hysteresis loops and invert data points in the third quadrant to the first quadrant for line fitting (ordinary least squares) to estimate the paramagnetic/diamagnetic slope.</p></li>
<li><p>perform linearity test on the girdded original data (high field slope correction not applied)</p></li>
<li><p>at the same time, centering the high-field slope corrected data, and estiamte the optimal values for field and moment offsets.
Note that when iterating through different H_offset values on the inverted lower branch, the upper and lower branches will have a H field range mismatch. To account for this, in this code we just use the overlapping region for interpolation and ANOVA statistic.</p></li>
</ol>
<p>Testing with synthetic data shows that the exact offset results from this code is slightly different from that of the IRM database. But the results from this function <code class="docutils literal notranslate"><span class="pre">hyst_loop_centering</span></code> are self-consistent (add synthetic offset + or - results in the same corrected R^2 while the IRM function does not). Given that both functions finds the correct offset values, I use the new function</p>
<ol class="arabic simple" start="5">
<li><p>calcualte the Q value to represent the signal/noise ratio (data quality) of the whole loop (ferromagnetic component + paramagnetic (also + diamagnetic component)) after centering.</p></li>
<li><p>re-grid the original data with applying the estimated optimal values for field and moment offsets.</p></li>
<li><p>calcualte H and M errors for each data point.</p></li>
<li><p>calculate mrh, E_hys, Brh, Bih</p></li>
<li><p>use the sum of M errors to estimate signal drift correction</p></li>
<li><p>test saturation of the loop by calculating the FN60, 70, 80 statistics and determine where the loop start to saturate.</p></li>
<li><p>re-apply high field slope correction to the drift-corrected data</p></li>
<li><p>calculate the Qf value using the drift-corrected, high-field slope corrected data for the ferromagnetic component quanlity estiamtion.</p></li>
<li><p>calculate Hcminus, Hcplus, Mrplus, Mrminus, XMr, XHc</p></li>
</ol>
</section>
<section id="install-and-import-packages">
<h2>Install and import packages<a class="headerlink" href="#install-and-import-packages" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rockmag</span> <span class="k">as</span> <span class="nn">rmag</span>
<span class="kn">import</span> <span class="nn">pmagpy.ipmag</span> <span class="k">as</span> <span class="nn">ipmag</span>
<span class="kn">import</span> <span class="nn">pmagpy.contribution_builder</span> <span class="k">as</span> <span class="nn">cb</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span><span class="p">,</span> <span class="n">brent</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">least_squares</span>

<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">svd</span><span class="p">,</span> <span class="n">lstsq</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-data">
<h2>Import data<a class="headerlink" href="#import-data" title="Link to this heading">#</a></h2>
<p>We can take the same approach as in the <code class="docutils literal notranslate"><span class="pre">rockmag_data_unpack.ipynb</span></code> notebook to bring the MagIC data into the notebook as a Contribution.</p>
<p>To bring in a different contribution than the one shown in this example:</p>
<ul class="simple">
<li><p>set the directory path (currently <code class="docutils literal notranslate"><span class="pre">'./example_data/hyst'</span></code>)</p></li>
<li><p>set the <code class="docutils literal notranslate"><span class="pre">magic_id</span></code> (19216 for  <em>Swanson-Hysell et al., 2021</em>)</p></li>
<li><p>if the contribution is private, set the share key for your MagIC contribution which you can find by clicking on the “Share” button in the MagIC database.</p></li>
</ul>
<figure>
  <img src="https://raw.githubusercontent.com/PmagPy/RockmagPy-notebooks/main/book/images/MagIC_private_contribution_1.png" alt="Description of the image" width="800">
</figure>
<p>Copy the share key highlighted in grey in the following image to the <code class="docutils literal notranslate"><span class="pre">share_key</span></code> parameter in the cell below.</p>
<figure>
  <img src="https://raw.githubusercontent.com/PmagPy/RockmagPy-notebooks/main/book/images/MagIC_private_contribution_2.png" alt="Description of the image" width="800">
</figure></section>
<section id="load-local-data">
<h2>Load local data<a class="headerlink" href="#load-local-data" title="Link to this heading">#</a></h2>
<p>In this demonstration we will be using local data.</p>
<p>The data is from the following publication:</p>
<ul class="simple">
<li><p>Swanson-Hysell, N. L., Avery, M. S., Zhang, Y., Hodgin, E. B., Sherwood, R. J., Apen, F. E., et al. (2021). The paleogeography of Laurentia in its early years: New constraints from the Paleoproterozoic East-Central Minnesota Batholith. Tectonics, 40, e2021TC006751. <a class="reference external" href="https://doi.org/10.1029/2021TC006751">https://doi.org/10.1029/2021TC006751</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the dir_path to the directory where the measurements.txt file is located</span>
<span class="n">dir_path</span> <span class="o">=</span> <span class="s1">&#39;./example_data/ECMB&#39;</span>

<span class="c1"># set the name of the MagIC file</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">unpack_magic</span><span class="p">(</span><span class="s1">&#39;ECMB 2018.TXT&#39;</span><span class="p">,</span> 
                     <span class="n">dir_path</span> <span class="o">=</span> <span class="n">dir_path</span><span class="p">,</span>
                     <span class="n">input_dir_path</span> <span class="o">=</span> <span class="n">dir_path</span><span class="p">)</span>

<span class="c1"># create a contribution object from the tables in the directory</span>
<span class="n">contribution</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">Contribution</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
<span class="n">measurements</span> <span class="o">=</span> <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;measurements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>working on:  &#39;contribution\r&#39;
1  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/contribution.txt
  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/contribution.txt
working on:  &#39;specimens\r&#39;
15  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/specimens.txt
  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/specimens.txt
working on:  &#39;samples\r&#39;
5  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/samples.txt
  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/samples.txt
working on:  &#39;sites\r&#39;
5  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/sites.txt
  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/sites.txt
working on:  &#39;locations\r&#39;
10  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/locations.txt
  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/locations.txt
working on:  &#39;measurements\r&#39;
5018  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/measurements.txt
  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/ECMB/measurements.txt
-I- Using online data model
-I- Getting method codes from earthref.org
-I- Importing controlled vocabularies from https://earthref.org
</pre></div>
</div>
</div>
</div>
</section>
<section id="all-of-the-project-data-is-now-stored-in-the-measurements-variable">
<h2>All of the project data is now stored in the <span class="math notranslate nohighlight">\(measurements\)</span> variable<a class="headerlink" href="#all-of-the-project-data-is-now-stored-in-the-measurements-variable" title="Link to this heading">#</a></h2>
<p>The method codes relevent to hysteresis loops are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LP-HYS</span></code> for regular hysteresis loops</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LP-HYS-O</span></code> for hysteresis loops as a function of orientation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LP-HYS-T</span></code> for hysteresis loops as a function of temperature</p></li>
</ul>
</section>
<section id="inspect-the-original-data">
<h2>Inspect the original data<a class="headerlink" href="#inspect-the-original-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the hysteresis loop (only looking for &#39;LP-HYS&#39;)</span>
<span class="n">specimen</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">make_hyst_plots</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1637f1ac38134276b0c8a338d695e302", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7006364282364e04859065eb1831bf22", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e138f9ae477a4466991825afaaee06af", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="loop-processing">
<h2>Loop processing<a class="headerlink" href="#loop-processing" title="Link to this heading">#</a></h2>
<p>We aim to offer the ability to calculate the hysteresis loop parameters as available in the IRMDB software, with the goal of being able to export the statistics into the MagIC specimen data table.</p>
<figure>
  <img src="https://raw.githubusercontent.com/PmagPy/RockmagPy-notebooks/main/book/images/IRM_hyst_processing_screenshot.png" alt="Description of the image" width="800">
</figure>
<p>The automated processing function will follow the workflow presented in Paterson et al., 2018</p>
<figure>
  <img src="https://raw.githubusercontent.com/PmagPy/RockmagPy-notebooks/main/book/images/hyst_loo_processing_workflow.png" alt="Description of the image" width="500">
</figure>
<section id="select-specimen-hysteresis-data">
<h3>select specimen hysteresis data<a class="headerlink" href="#select-specimen-hysteresis-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract the specimen specific data, for this demonstration, we use specimen NED18-2c</span>
<span class="n">hyst_data</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">extract_hysteresis_data</span><span class="p">(</span><span class="n">measurements</span><span class="p">,</span> <span class="s1">&#39;NED1-5c&#39;</span><span class="p">)</span>

<span class="n">loop_fields</span> <span class="o">=</span> <span class="n">hyst_data</span><span class="p">[</span><span class="s1">&#39;meas_field_dc&#39;</span><span class="p">]</span>
<span class="n">loop_magnetizations</span> <span class="o">=</span> <span class="n">hyst_data</span><span class="p">[</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="execute-default-hysteresis-processing-procedure-following-the-flowchart-above">
<h3>execute default hysteresis processing procedure following the flowchart above<a class="headerlink" href="#execute-default-hysteresis-processing-procedure-following-the-flowchart-above" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">process_hyst_loop</span><span class="p">(</span><span class="n">loop_fields</span><span class="p">,</span> <span class="n">loop_magnetizations</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>raw data is not linear
FNL:  10478.66
loop centering results: field offset = 0.0 T magnetization offset = 0.0006 Am^2/kg
centered loop Q value: 3.19
apply default high field linear correction: slope (X_para/dia) = 0.1647 intercept (Ms) = 0.0339 Am^2/kg
SNR = -89.3 dB
HAR = -40.97 dB
loop is open!
loop is saturated beyond 600.6 mT
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/edaa974d9e100b5ec13320cd99ed7e22decc5090bad4c6d3723a70fb283cd72d.png"><img alt="_images/edaa974d9e100b5ec13320cd99ed7e22decc5090bad4c6d3723a70fb283cd72d.png" src="_images/edaa974d9e100b5ec13320cd99ed7e22decc5090bad4c6d3723a70fb283cd72d.png" style="width: 873px; height: 857px;" /></a>
</div>
</div>
</section>
<section id="inspect-the-loop-processing-stats">
<h3>inspect the loop processing stats<a class="headerlink" href="#inspect-the-loop-processing-stats" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;loop_centering_results&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;opt_H_offset&#39;: 0.0,
 &#39;opt_M_offset&#39;: 0.0006706780851330234,
 &#39;R_squared&#39;: 0.9999971889892862,
 &#39;M_sn&#39;: 596.4427302801345,
 &#39;Q&#39;: 2.7755687495698718}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;loop_saturation_stats&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;FNL60&#39;: 86.44996220281047,
 &#39;FNL70&#39;: 65.09077978574224,
 &#39;FNL80&#39;: 47.38282395967419,
 &#39;saturation_cutoff&#39;: 0.92}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="manually-apply-loop-drift-correction">
<h2>Manually apply loop drift correction<a class="headerlink" href="#manually-apply-loop-drift-correction" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>in the example of NED18-2c above, the loop drift is present (subtle, but significant such that the upper and lower branches of the loop do not overlap toward 1T).</p></li>
<li><p>We can see in the IRM software such drift is not automatically corrected for. It is upon user’s discretion to apply drift corrections.</p></li>
<li><p>Below we will walk through the drift correction process as described in Jackson and Solheid, 2010.</p></li>
</ul>
<section id="positive-field-correction">
<h3>positive field correction<a class="headerlink" href="#positive-field-correction" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>One type of drift correction is to apply a prorated drift correction based on the value of Mce which is the difference between measured magnetizations at the highest positive fields applied during the upper and lower branches.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_example_magnetizations_centered_HF_drift_corr</span> <span class="o">=</span> <span class="n">prorated_drift_correction</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered_HF_corr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_hysteresis_loop</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered</span><span class="p">,</span> 
                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;centered raw data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered_HF_corr</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HF slope corrected data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered_HF_drift_corr</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HF &amp; drift slope corrected data&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">hyst_loop_saturation_test</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered_HF_corr</span><span class="p">))</span>
<span class="c1"># plt.xlim(0.8, 1)</span>
<span class="c1"># plt.ylim(0.09, 0.11)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;FNL60&#39;: 86.44996220294112, &#39;FNL70&#39;: 65.09077978572896, &#39;FNL80&#39;: 47.382823959654054, &#39;saturation_cutoff&#39;: 0.92}
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/e2bbdcda948a8d7b30efb1b54b90a151a50bbf5def192675d77ab924561a0386.png"><img alt="_images/e2bbdcda948a8d7b30efb1b54b90a151a50bbf5def192675d77ab924561a0386.png" src="_images/e2bbdcda948a8d7b30efb1b54b90a151a50bbf5def192675d77ab924561a0386.png" style="width: 864px; height: 857px;" /></a>
</div>
</div>
</section>
<section id="upper-branch-correction">
<h3>upper branch correction<a class="headerlink" href="#upper-branch-correction" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The upper branch correction subtracts the smoothed noise curve from the upper branch of the hysteresis loop (Jackson &amp; Solheid, 2010)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">upper_branch_drift_corr</span> <span class="o">=</span> <span class="n">upper_brach_drift_correction</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered_HF_corr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># ax = plot_hysteresis_loop(ax, grid_example_fields_centered, grid_example_magnetizations_centered, </span>
<span class="c1">#                           color=&#39;r&#39;, linewidth=1, label=&#39;centered raw data&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered_HF_corr</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HF slope corrected data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered_HF_drift_corr</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HF &amp; drift slope corrected data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">upper_branch_drift_corr</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;upper branch drift corrected data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c1"># plt.xlim(0.8, 1)</span>
<span class="c1"># plt.ylim(0.09, 0.11)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/099e9db206ab50764d151577d75fcde3e5b91b940e5cdd9981dba2e276b19b11.png"><img alt="_images/099e9db206ab50764d151577d75fcde3e5b91b940e5cdd9981dba2e276b19b11.png" src="_images/099e9db206ab50764d151577d75fcde3e5b91b940e5cdd9981dba2e276b19b11.png" style="width: 847px; height: 813px;" /></a>
</div>
</div>
</section>
<section id="symmetric-averaging">
<h3>Symmetric averaging<a class="headerlink" href="#symmetric-averaging" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Symmetric averaging follows von Dobeneck (1996), whereby the upper and inverted lower branches are averaged and vertically shifted by half their tip-to-tip separation to ensure loop closure.</p></li>
<li><p>In this demo case, symmetric average does not work well.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">symmetric_averaging_drift_corr</span> <span class="o">=</span> <span class="n">symmetric_averaging_drift_corr</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">grid_example_magnetizations_centered_HF_corr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid_example_fields_centered</span><span class="p">,</span> <span class="n">symmetric_averaging_drift_corr</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;symmetric averaging drift corrected data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c1"># plt.xlim(0.8, 1)</span>
<span class="c1"># plt.ylim(0.09, 0.11)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/7a2c8710c2bcd56cd8cc611e24aee048284e0eae8a077c8247e96450cc4cbd64.png"><img alt="_images/7a2c8710c2bcd56cd8cc611e24aee048284e0eae8a077c8247e96450cc4cbd64.png" src="_images/7a2c8710c2bcd56cd8cc611e24aee048284e0eae8a077c8247e96450cc4cbd64.png" style="width: 847px; height: 813px;" /></a>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Anisotropy_plot_AMS.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Plot and analyze anisotropy data (AMS)</p>
      </div>
    </a>
    <a class="right-next"
       href="book/resources.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Resources for learning more about rock magnetism</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#workflow-for-hysteresis-processing">Workflow for hysteresis processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-packages">Install and import packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-data">Import data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-local-data">Load local data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#all-of-the-project-data-is-now-stored-in-the-measurements-variable">All of the project data is now stored in the <span class="math notranslate nohighlight">\(measurements\)</span> variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-original-data">Inspect the original data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-processing">Loop processing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-specimen-hysteresis-data">select specimen hysteresis data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-default-hysteresis-processing-procedure-following-the-flowchart-above">execute default hysteresis processing procedure following the flowchart above</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-loop-processing-stats">inspect the loop processing stats</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manually-apply-loop-drift-correction">Manually apply loop drift correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#positive-field-correction">positive field correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upper-branch-correction">upper branch correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetric-averaging">Symmetric averaging</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By RockmagPy Contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>