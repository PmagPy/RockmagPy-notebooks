
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Analysis of susceptibility-temperature, (Kappabridge \(\chi\)-T), data &#8212; RockmagPy Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'high_T_susceptibility';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plot and analyze anisotropy data (AMS)" href="Anisotropy_plot_AMS.html" />
    <link rel="prev" title="Fit and remove the goethite component" href="MPMS_goethite_fit.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="book/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/rockmagpy.png" class="logo__image only-light" alt="RockmagPy Documentation - Home"/>
    <script>document.write(`<img src="_static/rockmagpy.png" class="logo__image only-dark" alt="RockmagPy Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="book/intro.html">
                    RockmagPy: tools for rock magnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Nuts &amp; Bolts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rockmag_set_up.html">Getting going with rockmag.py on JupyterHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="rockmag_data_unpack.html">Rock magnetic experiments data import</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MPMS notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot_dc.html">Plot MPMS data (DC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_plot_ac.html">Plot MPMS data (AC susceptibility)</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_verwey_fit.html">Estimate the Verwey transition temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="MPMS_goethite_fit.html">Fit and remove the goethite component</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermomagnetic notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Analysis of susceptibility-temperature, <span style="font-family: 'Times New Roman';"><em>(Kappabridge <span class="math notranslate nohighlight">\(\chi\)</span>-T)</em></span>, data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Anisotropy notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Anisotropy_plot_AMS.html">Plot and analyze anisotropy data (AMS)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">More resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="book/resources.html">Resources for learning more about rock magnetism</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pmagpy/rockmagpy-notebooks/issues/new?title=Issue%20on%20page%20%2Fhigh_T_susceptibility.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/high_T_susceptibility.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analysis of susceptibility-temperature, <span style="font-family: 'Times New Roman';">(Kappabridge \chi-T)</span>, data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-packages">Install and import packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-data">Import data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-project-export-contains-data-from-all-the-experiments">The project export contains data from all the experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-a-chi-t-experiment">Select a <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span> Experiment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-chi-t-data-the-derivatives-and-inverse-chi-t">Plot <span class="math notranslate nohighlight">\(\chi\)</span>-T data, the derivatives, and inverse <span class="math notranslate nohighlight">\(\chi\)</span>-T</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-tc-using-inverse-susceptibility">Calculate <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> using inverse susceptibility</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-the-figures">Save the figures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determining-the-best-temperature-window-for-smoothing">Determining the best temperature window for smoothing</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analysis-of-susceptibility-temperature-kappabridge-chi-t-data">
<h1>Analysis of susceptibility-temperature, <span style="font-family: 'Times New Roman';"><em>(Kappabridge <span class="math notranslate nohighlight">\(\chi\)</span>-T)</em></span>, data<a class="headerlink" href="#analysis-of-susceptibility-temperature-kappabridge-chi-t-data" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<p>This notebook allows the user to:</p>
<p>(1) Download a contribution from the MagIC database.</p>
<p>(2) Extract any susceptibility-temperature, <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span>, data contained within it.</p>
<p>(3) Correct for the diamagnetic signal of the measurement instrument and holder (optional).</p>
<p>(4) Smooth the data prior to further anaysis (optional).</p>
<p>(5) Calculate Curie Temperatures, <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span>, using first and second-order derivatives.</p>
<p>The notebook is to be run cell-by-cell to allow users to select corrections/filters as needed. The code below runs an example dataset from <a class="reference external" href="https://doi.org/10.1029/2021JB023789">Doctor and Feinberg (2022)</a>, Differential thermal analysis using high temperature susceptibility instruments, <em>Journal of Geophysical Research: Solid Earth</em>, which is MagiC contribution <a class="reference external" href="http://dx.doi.org/10.7288/V4/MAGIC/19369">19369</a>. Any MagIC contribution which contains <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span> data can be used in place of this example dataset.</p>
<p><strong>Nota bene:</strong> We do not provide Curie Temperature estimation by the “two-tangent” method, as proposed for spontaneous magnetization  <span style="font-family: 'Times New Roman';"><em>M<sub>s</sub>(T)</em></span> curves by <a class="reference external" href="https://doi.org/10.1029/JB074i022p05277">Grommé et al. (1969)</a>. <a class="reference external" href="https://doi.org/10.1029/2012GC004440">Fabian et al. (2013)</a> explain this well:</p>
<p><em>“The importance of the difference between determining <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> from <span style="font-family: 'Times New Roman';">M<sub>s</sub>(T)</span> and <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span> is pointed out by <a class="reference external" href="https://doi.org/10.1029/2006JB004507">Petrovský and Kapicka (2006)</a>, where methods to determine <span style="font-family: 'Times New Roman';">T<sub>c</sub></span> from measurements of the initial susceptibility are analyzed. They conclude that the two-tangent method is not suitable for <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span> and can considerably overestimate <span style="font-family: 'Times New Roman';">T<sub>c</sub></span>. The physical origin of  <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span> close to <span style="font-family: 'Times New Roman';">T<sub>c</sub></span> is more challenging than that of <span style="font-family: 'Times New Roman';">M<sub>s</sub>(T)</span>, because a number of low-field effects are important for <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span>, but become negligible in the higher fields used to infer <span style="font-family: 'Times New Roman';">M<sub>s</sub>(T)</span>. The variation of <span style="font-family: 'Times New Roman';">m</span> depends not only on the variation of <span style="font-family: 'Times New Roman';">M<sub>s</sub>(H,T)</span> with field  <span style="font-family: 'Times New Roman';">H</span>, it also contains a contribution from a rotation of the ordered moment with respect to an easy magnetization axis, and contributions from thermally activated switching of small independent – but already magnetically ordered – regions (e.g., SP particles). In large bulk material domain-wall movement contributes to <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span> even slightly below  <span style="font-family: 'Times New Roman';">Tc</span>. In nanoparticles the inhomogeneity of <span style="font-family: 'Times New Roman';">M<sub>s</sub></span>, due to the different exchangecoupling of inner and surface atoms, is of additional importance.”</em></p>
<p>And from <a class="reference external" href="https://doi.org/10.1029/2006JB004507">Petrovský and Kapicka (2006)</a>:</p>
<p><em>“…susceptibility for T [to] <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> and T &lt; <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> increases to infinity, and we have to use analytical formulas developed for susceptibility behavior above the Curie point. Here, due to the geometry of the susceptibility curve, the two-tangent method will always yield temperature above the inflection point, which is higher than the temperature at which the substance starts to obey the paramagnetic Curie-Weiss law. The resulting error in <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> (or <span style="font-family: 'Times New Roman';">T<sub>N</sub><sup>1</sup></span>) can be on the order of several degrees to several tens of degrees. Therefore, in the case of temperature dependence of magnetic susceptibility, application of the two-tangent method is not justified.”</em></p>
<p>Furthermore:</p>
<p><em>“In the case of synthetic magnetite and hematite, with sharp Hopkinson peak, the difference between transition
temperatures determined using the two-tangent method and Curie-Weiss paramagnetic law is in the order of some few
degrees. In the case of samples with wide susceptibility maximum and gradual decrease, reflecting e.g., wide distribution
of grain sizes, or in the case of substituted hematite, application of the two-tangent method to susceptibility curves overestimates the transition temperature be several tens of degrees.”</em></p>
<p><sup>1</sup>Néel Temperature</p>
<p>Key components here include portions of notebooks, and functions developed for the EarthRef JupyterHub:
<a class="reference external" href="https://www2.earthref.org/MagIC/jupyter-notebooks">https://www2.earthref.org/MagIC/jupyter-notebooks</a></p>
<section id="install-and-import-packages">
<h2>Install and import packages<a class="headerlink" href="#install-and-import-packages" title="Link to this heading">#</a></h2>
<p>Click inside the cell below, hold shift and then press enter. This will automatically run the script below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rockmag</span> <span class="k">as</span> <span class="nn">rmag</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pmagpy.ipmag</span> <span class="k">as</span> <span class="nn">ipmag</span>
<span class="kn">import</span> <span class="nn">pmagpy.contribution_builder</span> <span class="k">as</span> <span class="nn">cb</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># import plotly.express as px</span>
<span class="c1"># import plotly.offline as pyo</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>


<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>

<span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">clear_output</span><span class="p">,</span> <span class="n">Javascript</span> 
<span class="kn">from</span> <span class="nn">notebook</span> <span class="kn">import</span> <span class="n">notebookapp</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-data">
<h2>Import data<a class="headerlink" href="#import-data" title="Link to this heading">#</a></h2>
<p>We can take the same approach as in the <code class="docutils literal notranslate"><span class="pre">rockmag_data_unpack.ipynb</span></code> notebook to bring the MagIC data into the notebook as a Contribution.</p>
<p>To bring in a different contribution than the one shown in this example:</p>
<ul class="simple">
<li><p>set the directory path (currently <code class="docutils literal notranslate"><span class="pre">'./example_data/X-T'</span></code>)</p></li>
<li><p>set the <code class="docutils literal notranslate"><span class="pre">magic_id</span></code> (19369 for  <em>Doctor and Feinberg (2022)</em>)</p></li>
<li><p>if the contribution is private, set the share key for your MagIC contribution which you can find by clicking on the “Share” button in the MagIC database.</p></li>
</ul>
<figure>
  <img src="https://raw.githubusercontent.com/PmagPy/RockmagPy-notebooks/main/book/images/MagIC_private_contribution_1.png" alt="Description of the image" width="800">
</figure>
<p>Copy the share key highlighted in grey in the following image to the <code class="docutils literal notranslate"><span class="pre">share_key</span></code> parameter in the cell below.</p>
<figure>
  <img src="https://raw.githubusercontent.com/PmagPy/RockmagPy-notebooks/main/book/images/MagIC_private_contribution_2.png" alt="Description of the image" width="800">
</figure><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define these three parameters to match your data</span>
<span class="n">magic_id</span> <span class="o">=</span> <span class="s1">&#39;19369&#39;</span>
<span class="n">share_key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">dir_path</span> <span class="o">=</span> <span class="s1">&#39;example_data/X-T&#39;</span>

<span class="n">result</span><span class="p">,</span> <span class="n">magic_file</span> <span class="o">=</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">download_magic_from_id</span><span class="p">(</span><span class="n">magic_id</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">share_key</span><span class="o">=</span><span class="n">share_key</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">unpack_magic</span><span class="p">(</span><span class="n">magic_file</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">)</span>
<span class="n">contribution</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">Contribution</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
<span class="n">measurements</span> <span class="o">=</span> <span class="n">contribution</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;measurements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span>
<span class="n">measurements</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download successful. File saved to: example_data/X-T/magic_contribution_19369.txt
working on:  &#39;contribution&#39;
1  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/contribution.txt
contribution  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/contribution.txt
working on:  &#39;locations&#39;
2  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/locations.txt
locations  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/locations.txt
working on:  &#39;sites&#39;
6  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/sites.txt
sites  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/sites.txt
working on:  &#39;samples&#39;
12  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/samples.txt
samples  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/samples.txt
working on:  &#39;specimens&#39;
52  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/specimens.txt
specimens  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/specimens.txt
working on:  &#39;measurements&#39;
20923  records written to file  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/measurements.txt
measurements  data put in  /Users/yimingzhang/Github/RockmagPy-notebooks/example_data/X-T/measurements.txt
-I- Using online data model
-I- Getting method codes from earthref.org
-I- Importing controlled vocabularies from https://earthref.org
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>citations</th>
      <th>experiment</th>
      <th>instrument_codes</th>
      <th>meas_field_ac</th>
      <th>meas_freq</th>
      <th>meas_temp</th>
      <th>measurement</th>
      <th>method_codes</th>
      <th>quality</th>
      <th>specimen</th>
      <th>standard</th>
      <th>susc_chi_mass</th>
      <th>sequence</th>
    </tr>
    <tr>
      <th>measurement name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IRM-KappaF-5928-1</th>
      <td>This study</td>
      <td>IRM-KappaF-5928</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>298.9</td>
      <td>IRM-KappaF-5928-1</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>BHRS13-2B5L1A_01</td>
      <td>u</td>
      <td>0.000001</td>
      <td>1</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5928-2</th>
      <td>This study</td>
      <td>IRM-KappaF-5928</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>302.3</td>
      <td>IRM-KappaF-5928-2</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>BHRS13-2B5L1A_01</td>
      <td>u</td>
      <td>0.000001</td>
      <td>2</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5928-3</th>
      <td>This study</td>
      <td>IRM-KappaF-5928</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>307.4</td>
      <td>IRM-KappaF-5928-3</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>BHRS13-2B5L1A_01</td>
      <td>u</td>
      <td>0.000001</td>
      <td>3</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5928-4</th>
      <td>This study</td>
      <td>IRM-KappaF-5928</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>312.3</td>
      <td>IRM-KappaF-5928-4</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>BHRS13-2B5L1A_01</td>
      <td>u</td>
      <td>0.000001</td>
      <td>4</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5928-5</th>
      <td>This study</td>
      <td>IRM-KappaF-5928</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>316.9</td>
      <td>IRM-KappaF-5928-5</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>BHRS13-2B5L1A_01</td>
      <td>u</td>
      <td>0.000001</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5913-426</th>
      <td>This study</td>
      <td>IRM-KappaF-5913</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>328.4</td>
      <td>IRM-KappaF-5913-426</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>vivian_A03</td>
      <td>u</td>
      <td>0.000001</td>
      <td>20919</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5913-427</th>
      <td>This study</td>
      <td>IRM-KappaF-5913</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>326.6</td>
      <td>IRM-KappaF-5913-427</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>vivian_A03</td>
      <td>u</td>
      <td>0.000001</td>
      <td>20920</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5913-428</th>
      <td>This study</td>
      <td>IRM-KappaF-5913</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>325.0</td>
      <td>IRM-KappaF-5913-428</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>vivian_A03</td>
      <td>u</td>
      <td>0.000001</td>
      <td>20921</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5913-429</th>
      <td>This study</td>
      <td>IRM-KappaF-5913</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>323.6</td>
      <td>IRM-KappaF-5913-429</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>vivian_A03</td>
      <td>u</td>
      <td>0.000001</td>
      <td>20922</td>
    </tr>
    <tr>
      <th>IRM-KappaF-5913-430</th>
      <td>This study</td>
      <td>IRM-KappaF-5913</td>
      <td>IRM-KappaF</td>
      <td>0.000377</td>
      <td>920</td>
      <td>321.9</td>
      <td>IRM-KappaF-5913-430</td>
      <td>LP-X:LP-X-T</td>
      <td>g</td>
      <td>vivian_A03</td>
      <td>u</td>
      <td>0.000001</td>
      <td>20923</td>
    </tr>
  </tbody>
</table>
<p>20923 rows × 13 columns</p>
</div></div></div>
</div>
</section>
<section id="the-project-export-contains-data-from-all-the-experiments">
<h2>The project export contains data from all the experiments<a class="headerlink" href="#the-project-export-contains-data-from-all-the-experiments" title="Link to this heading">#</a></h2>
<p>Each measurement in a MagIC measurements table has a <code class="docutils literal notranslate"><span class="pre">method_codes</span></code> value. These method codes come from a “controlled vocabulary” (<a class="reference external" href="https://www2.earthref.org/MagIC/method-codes">https://www2.earthref.org/MagIC/method-codes</a>).</p>
<p>In the method codes used for the example contribution:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LP</span></code> refers to lab protocol</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X-T</span></code> refers to susceptibility vs. temperature experiments done on the Kappabridge</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measurements</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;LP-X:LP-X-T&#39;, &#39;LP-X-T&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-a-chi-t-experiment">
<h2>Select a <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span> Experiment<a class="headerlink" href="#select-a-chi-t-experiment" title="Link to this heading">#</a></h2>
<p><em>Creates a dropdown to select specimens with <span style="font-family: 'Times New Roman';"></em><span class="math notranslate nohighlight">\(\chi\)</span><em>-T</span> data.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimen</span><span class="p">,</span> <span class="n">experiment</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">interactive_specimen_experiment_selection</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f74e9a159f4d41cd913bcca425e5420e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a557f8f07833436994127a2fe0c3afef", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_experiment</span> <span class="o">=</span> <span class="n">measurements</span><span class="p">[(</span><span class="n">measurements</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">specimen</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">&amp;</span> 
                                      <span class="p">(</span><span class="n">measurements</span><span class="p">[</span><span class="s1">&#39;experiment&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">experiment</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-chi-t-data-the-derivatives-and-inverse-chi-t">
<h2>Plot <span class="math notranslate nohighlight">\(\chi\)</span>-T data, the derivatives, and inverse <span class="math notranslate nohighlight">\(\chi\)</span>-T<a class="headerlink" href="#plot-chi-t-data-the-derivatives-and-inverse-chi-t" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>to help determine Curie temperatures or assessing reversibility for understanding alteration</p></li>
<li><p>Your data might be noisy, which may hinder interpretation of Curie Temperatures or assessing reversibility for understanding alteration. The following code will perform a running average of data over a temperature interval that you can define. In the following cell, change the value associated with variable <code class="docutils literal notranslate"><span class="pre">temp_window</span></code> to set the desired temperature window for the running average.</p></li>
<li><p>Holder removal: If you would like to remove the holder signal from the data, select values associated with <code class="docutils literal notranslate"><span class="pre">min_temp</span></code> and <code class="docutils literal notranslate"><span class="pre">max_temp</span></code> to set the temperature range for calculating the average value for the holder.</p></li>
</ul>
<p>Three graphs will be created.</p>
<p>(1) The top graph shows the raw data as points and the smoothed data as lines, for the temperature window size selected.</p>
<p>(2) The second graph plots the derivatives based on the smoothed data in the top graph.</p>
<p>(3) The third graph plots the inverse susceptibility data, which can be used to assess the Curie temperature.</p>
<section id="calculate-tc-using-inverse-susceptibility">
<h3>Calculate <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> using inverse susceptibility<a class="headerlink" href="#calculate-tc-using-inverse-susceptibility" title="Link to this heading">#</a></h3>
<p>Above <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> a mineral phase will be paramagnetic. This means that the inverse susceptibility should have a linear positive slope above <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span>. Using the intercept temperature at 0 inverse susceptibility is a good guess for  <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span>. This is essentially the break of slope between the ferromagnetic and paramagnetic signal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">fig_dXdT</span><span class="p">,</span> <span class="n">fig_inv</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">plot_X_T</span><span class="p">(</span><span class="n">selected_experiment</span><span class="p">,</span> 
                                       <span class="n">temp_unit</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> 
                                       <span class="n">remove_holder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                       <span class="n">min_temp</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">max_temp</span><span class="o">=</span><span class="mi">630</span><span class="p">,</span> 
                                       <span class="n">smooth_window</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
</section>
<section id="save-the-figures">
<h2>Save the figures<a class="headerlink" href="#save-the-figures" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## code for saving the figures in png format</span>
<span class="c1"># save the first figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;fig.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the dX/dT figure</span>
<span class="n">fig_dXdT</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;fig_dXdT.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the 1/X vs T figure</span>
<span class="n">fig_inv</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;fig_inv.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="determining-the-best-temperature-window-for-smoothing">
<h2>Determining the best temperature window for smoothing<a class="headerlink" href="#determining-the-best-temperature-window-for-smoothing" title="Link to this heading">#</a></h2>
<p>The following function plots the <strong>model roughness</strong> against the <strong>root mean square error</strong> of the model <strong>(note that the y-axis is inverted)</strong> (a measure of the difference between the running average and the data). Each point on the graph is for a different temperature window size. The <code class="docutils literal notranslate"><span class="pre">knee</span></code> in the curve (the break of slope) is the optimal tempeature window. At this point (window) there is a decent trade off between the smoothness of the model (the running average) and error on the model.</p>
<p>set values for <code class="docutils literal notranslate"><span class="pre">min_temp_window</span></code> and <code class="docutils literal notranslate"><span class="pre">max_temp_window</span></code> to set the temperature range for exploring the rms and variance tradeoff.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_temp_window</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">max_temp_window</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">rmag</span><span class="o">.</span><span class="n">optimize_X_T_running_average_window</span><span class="p">(</span><span class="n">selected_experiment</span><span class="p">,</span> <span class="n">min_temp_window</span><span class="p">,</span> <span class="n">max_temp_window</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/20be8cb8df2957bdb7cf30f2057c9843ff9af321296a5e55e7376552d034bfed.png"><img alt="_images/20be8cb8df2957bdb7cf30f2057c9843ff9af321296a5e55e7376552d034bfed.png" src="_images/20be8cb8df2957bdb7cf30f2057c9843ff9af321296a5e55e7376552d034bfed.png" style="width: 713px; height: 551px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;optimize_window_size.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MPMS_goethite_fit.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Fit and remove the goethite component</p>
      </div>
    </a>
    <a class="right-next"
       href="Anisotropy_plot_AMS.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Plot and analyze anisotropy data (AMS)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-and-import-packages">Install and import packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-data">Import data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-project-export-contains-data-from-all-the-experiments">The project export contains data from all the experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-a-chi-t-experiment">Select a <span style="font-family: 'Times New Roman';"><em><span class="math notranslate nohighlight">\(\chi\)</span>-T</em></span> Experiment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-chi-t-data-the-derivatives-and-inverse-chi-t">Plot <span class="math notranslate nohighlight">\(\chi\)</span>-T data, the derivatives, and inverse <span class="math notranslate nohighlight">\(\chi\)</span>-T</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-tc-using-inverse-susceptibility">Calculate <span style="font-family: 'Times New Roman';"><em>T<sub>c</sub></em></span> using inverse susceptibility</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-the-figures">Save the figures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determining-the-best-temperature-window-for-smoothing">Determining the best temperature window for smoothing</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By RockmagPy Contributors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>